<!DOCTYPE html><html lang="en" data-theme="lofi"> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/jpeg" href="/tech/profile.jpg"><meta name="generator" content="Astro v4.4.15"><!-- Primary Meta Tags --><title>Writing your own HTTP server | Kieran Wood</title><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><meta name="title" content="Writing your own HTTP server"><meta name="description" content="Ever wanted to write your own HTTP server? This series will show you how to do it. HHTTPP; Writing your own HTTP server Part 1/5"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://kieranwood.ca/tech/blog/series-introduction/"><meta property="og:title" content="Writing your own HTTP server"><meta property="og:description" content="Ever wanted to write your own HTTP server? This series will show you how to do it. HHTTPP; Writing your own HTTP server Part 1/5"><meta property="og:image" content="https://kieranwood.ca/tech/blog/hhttpp/hero.jpg"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://kieranwood.ca/tech/blog/series-introduction/"><meta property="twitter:title" content="Writing your own HTTP server"><meta property="twitter:description" content="Ever wanted to write your own HTTP server? This series will show you how to do it. HHTTPP; Writing your own HTTP server Part 1/5"><meta property="twitter:image" content="https://kieranwood.ca/tech/blog/hhttpp/hero.jpg"><link rel="stylesheet" href="/tech/_astro/_page_.D_l8DYJv.css" />
<style>.time-line-container>div:last-child .education__time>.education__line{display:none}details{background:#f0f0f0;padding:1rem;border-radius:.7rem;margin:.5rem auto;width:100%}summary{cursor:pointer}#TOC-list{list-style:none}#TOC-list li{margin-top:.15rem}.danger-banner{display:flex;flex-direction:row;background:#f44336;border-radius:.25rem;padding:1.1rem;color:#fff!important;flex-wrap:wrap}.danger-banner strong,.danger-banner a{color:#fff!important}.danger-banner:before{content:"!üõë Danger üõë!";flex-basis:100%;margin-bottom:.5rem;padding:.6rem;border-radius:.25rem;text-align:center;background:red;text-transform:uppercase}.warning-banner{display:flex;flex-direction:row;background:#fcc51e;border-radius:.25rem;padding:1.1rem;color:#141414!important;flex-wrap:wrap}.warning-banner strong,.warning-banner a{color:#141414!important}.warning-banner:before{content:"üü° Warning üü°";flex-basis:100%;margin-bottom:.5rem;padding:.6rem;border-radius:.25rem;text-align:center;background:#f6cb49;text-transform:uppercase;text-shadow:1px 1px 1px rgb(93,93,93)}.astro-route-announcer{position:absolute;left:0;top:0;clip:rect(0 0 0 0);-webkit-clip-path:inset(50%);clip-path:inset(50%);overflow:hidden;white-space:nowrap;width:1px;height:1px}
@keyframes astroFadeInOut{0%{opacity:1}to{opacity:0}}@keyframes astroFadeIn{0%{opacity:0}}@keyframes astroFadeOut{to{opacity:0}}@keyframes astroSlideFromRight{0%{transform:translate(100%)}}@keyframes astroSlideFromLeft{0%{transform:translate(-100%)}}@keyframes astroSlideToRight{to{transform:translate(100%)}}@keyframes astroSlideToLeft{to{transform:translate(-100%)}}@media (prefers-reduced-motion){::view-transition-group(*),::view-transition-old(*),::view-transition-new(*){animation:none!important}[data-astro-transition-scope]{animation:none!important}}
</style><script type="module" src="/tech/_astro/hoisted.CHePpst8.js"></script><style>[data-astro-transition-scope="astro-vz7ejtmd-1"] { view-transition-name: __2ftech_2fblog_2fhhttpp_2fhero_2ejpg; }</style><style>[data-astro-transition-scope="astro-frvnq75b-2"] { view-transition-name: Writing_20your_20own_20HTTP_20server; }</style></head> <body> <div class="bg-base-100 drawer lg:drawer-open"> <input id="my-drawer" type="checkbox" class="drawer-toggle"> <div class="drawer-content bg-base-100"> <div class="sticky lg:hidden top-0 z-30 flex h-16 w-full justify-center bg-opacity-90 backdrop-blur transition-all duration-100 bg-base-100 text-base-content shadow-sm"> <div class="navbar"> <div class="navbar-start"> <label for="my-drawer" class="btn btn-square btn-ghost"> <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block w-5 h-5 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path> </svg> </label> </div> <div class="navbar-center"> <a class="btn btn-ghost normal-case text-xl" href="/">Kieran Wood ‚ö°Ô∏è</a> </div> <div class="navbar-end"></div> </div> </div> <div class="md:flex md:justify-center"> <main class="p-6 pt-10 lg:max-w-[900px] max-w-[100vw]">  <main class="md:flex md:justify-center"> <article class="prose prose-lg max-w-[750px] prose-img:mx-auto"> <img src="/tech/blog/hhttpp/hero.jpg" alt="Writing your own HTTP server" class="w-full mb-6" style="border-radius:.5em" data-astro-transition-scope="astro-vz7ejtmd-1" width="750" height="422" loading="lazy" decoding="async"> <h1 class="title my-2 text-4xl font-bold" data-astro-transition-scope="astro-frvnq75b-2">Writing your own HTTP server</h1> <time>Aug 28, 2023</time> <br>  <a href="/blog/tag/python" class="badge badge-outline ml-2 no-underline"> python </a><a href="/blog/tag/scorch" class="badge badge-outline ml-2 no-underline"> scorch </a><a href="/blog/tag/web" class="badge badge-outline ml-2 no-underline"> web </a><a href="/blog/tag/theory" class="badge badge-outline ml-2 no-underline"> theory </a>  <p class="text-lg text-italics">Crossposted from <a class="text-violet-700" target="_blank" href="https://schulichignite.com/blog/hhttpp/series-introduction/">https://schulichignite.com/blog/hhttpp/series-introduction/</a></p> <div class="divider my-2"></div> <div> <h2>Table of contents</h2> <ul id="TOC-list"> <li> <a href="#terms--concepts" class="no-underline"> Terms &amp; Concepts </a> </li><li> <a href="#anatomy-of-a-url" class="no-underline"> Anatomy of a URL </a> </li><li> <a href="#what-is-an-http-proxy" class="no-underline"> What is an HTTP proxy? </a> </li><li> <a href="#order-of-development" class="no-underline"> Order of development </a> </li><li> <a href="#source-code" class="no-underline"> Source code </a> </li><li> <a href="#code-a-long-ness" class="no-underline"> Code-a-long-ness </a> </li><li> <a href="#python-syntax" class="no-underline"> Python syntax </a> </li><li> <a href="#list-comprehensions" class="no-underline"> List comprehensions </a> </li><li> <a href="#type-hints" class="no-underline"> Type hints </a> </li><li> <a href="#dataclasses" class="no-underline"> Dataclasses </a> </li><li> <a href="#lambdas" class="no-underline"> Lambdas </a> </li><li> <a href="#project-setup" class="no-underline"> Project setup </a> </li><li> <a href="#how-pip-works" class="no-underline"> How pip works </a> </li><li> <a href="#customizing-the-template" class="no-underline"> Customizing the template </a> </li> </ul> </div>
  <hr><p>HTTP is the way that we communicate over the internet. It‚Äôs what allows you to see the content you‚Äôre currently looking at. The overall goal with the project is to create a simple <a href="#what-is-an-http-proxy">HTTP proxy server</a>. It is <strong>not</strong> designed to be a framework with routing, or any other fancy features.</p>
<p>On top of that, there are a few caveats:</p>
<ol>
<li>It will only support <strong>parts</strong> of the HTTP 1.1 spec (just enough to work for basic use)</li>
<li>It will only support a portion of the HTTP response codes</li>
<li>It will not have optimizations like caching or multithreading</li>
</ol>
<h2 id="terms--concepts">Terms &#x26; Concepts</h2>
<p>To start there are some terms we need to understand in order to understand HTTP (<a href="https://www.youtube.com/watch?v=SzSXHv8RKdM">this video is also pretty good</a>). Here are some of the basics:</p>






























<table><thead><tr><th>Term</th><th>Description</th><th>Example</th></tr></thead><tbody><tr><td>IP Address</td><td>This is what computers use to communicate with one another, it is similar to an actual address</td><td><code>127.0.0.1</code> is the IP address reserved for the computer you‚Äôre currently on, so if you need to communicate with yourself you can (this is useful for testing)</td></tr><tr><td>Port</td><td>A computer can have multiple servers running on it. Each of these ‚Äúservers‚Äù runs on a different port so you can communicate with them sparately</td><td>If you are running a server on your own machine and have it on port 8080 you can access it in a browser at <code>http://localhost:8080</code></td></tr><tr><td>Proxy/alias</td><td>In our context we‚Äôre using this to mean something that stands-in or is replaced by something else</td><td>For <code>localhost</code> is a proxy for <code>127.0.0.1</code> on your computer, so if you go to <code>localhost</code> it is the same as going to <code>127.0.0.1</code></td></tr><tr><td>Host</td><td>The name of a computer (local/on the machine)</td><td>Let‚Äôs say you gave your PC the name <code>thoth</code> when you set it up, then on your own network you can access it at <code>thoth</code> or <code>thoth.local</code> (an alias for an IP)</td></tr></tbody></table>
<h3 id="anatomy-of-a-url">Anatomy of a URL</h3>
<p>Some of the most important terms we need to understand are what makes up a URL. A URL is what we type into a browser bar to get to a site (i.e. <a href="https://schulichignite.com">https://schulichignite.com</a>). Here is a diagram breaking apart the different peices:</p>
<p><img src="/tech/blog/hhttpp/Post 1/url-anatomy.png" alt=""></p>
<p>For those of you that can‚Äôt read the image, this is the basic anatomy of a URL:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span>&#x3C;protocol>://&#x3C;domain/hostname/ip>:&#x3C;port(optional)>&#x3C;slug/URI></span></span></code></pre>
<p>For example here are some URL‚Äôs:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span>http://127.0.0.1:80/</span></span>
<span class="line"><span>http://localhost:8000/</span></span>
<span class="line"><span>http://thoth:32400/web/index</span></span>
<span class="line"><span>http://schulichignite.com/contact</span></span>
<span class="line"><span>http://example-site.co.uk/about-us</span></span></code></pre>



































<table><thead><tr><th>Term</th><th>Description</th><th>Example</th></tr></thead><tbody><tr><td>Protocol</td><td>The protocol is the rules and procedures that the browser should follow to communicate with the underlying server</td><td><code>http://</code>, <code>https://</code>, <code>file://</code></td></tr><tr><td>Domain</td><td>The name of a computer (remote/on a server accessible to the internet)</td><td>When you go to <code>google.ca</code> that is a domain, the domain itself is an alias for the IP address of a server that returns the webpage you‚Äôre looking for domains have 2 parts, the domain name, and the TLD</td></tr><tr><td>Domain Name</td><td>The domain name is the main portion of the domain, before the <code>.</code></td><td>google, netflix, schulichignite</td></tr><tr><td>TLD (top-level domain)</td><td>These groupings of domains used to serve more of a roll before, but now are mostly all the same. They are the letters that come after a <code>.</code> in a URL, and indicate usually which country the service is from</td><td><code>.ca</code>,<code>.com</code>,<code>.co.uk</code>,<code>.sh</code></td></tr><tr><td>Slug/URI</td><td>The part that comes after a domain to indicate which specific resource you want from the specified server on the specified port</td><td><code>/</code>, <code>/about</code>,<code>/blog/title</code></td></tr></tbody></table>
<h2 id="what-is-an-http-proxy">What is an HTTP proxy?</h2>
<p>A proxy server in this context is a server that will allow you to access the files in a given folder (called the proxy folder) over HTTP. So essentially when you access a URL on the proxy it will treat the slug as a path to a file. That was a lot of words, so lets look at an example. Let‚Äôs say you have a proxy folder:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span>üìÅproxy_folder/</span></span>
<span class="line"><span>‚îú‚îÄ‚îÄ üìÅblog/</span></span>
<span class="line"><span>‚îÇ   ‚îî‚îÄ‚îÄ üìÑhow-to-make-alfredo.html</span></span>
<span class="line"><span>‚îî‚îÄ‚îÄ üìÑ about.html</span></span></code></pre>
<p>Then if it‚Äôs proxied to <code>ignite.com</code> if you go to <code>ignite.com/about</code> it will send you the contents of <code>proxy_folder/about.html</code> over HTTP. Essentially <code>ignite.com</code> becomes an alias for <code>proxy_folder</code> and users are basically typing in glorified file paths to get your content. Same thing if you went to <code>ignite.com/blog/how-to-make-alfredo.html</code> would give you the content of <code>proxy_folder/blog/how-to-make-alfredo.html</code> via HTTP:</p>
<p><img src="/tech/blog/hhttpp/proxy-basics.png" alt=""></p>
<p>The functionality for hhttpp is based of the built in <code>http.server</code> module in python (in functionality, <strong>not approach</strong>). To see what this might look like open up a terminal inside <code>/example_site</code> and then run <code>python -m http.server 8118</code> from there go to your browser and type in <a href="http://localhost:8118">http://localhost:8118</a>. You will be able to access all the pages inside the folder from your browser!</p>
<p>In our case we will be using <a href="https://github.com/Descent098/HHTTPP/tree/master/example_site">these files</a>, which when hosted correctly look like <a href="https://kieranwood.ca/chat-blog/">this</a>. This is what we‚Äôre aiming to recreate with <code>hhttpp</code>!</p>
<h2 id="order-of-development">Order of development</h2>
<p>In order to get things to work we will first implement the HTTP information <strong>without</strong> real networking, once we have an HTTP implementation that works without networking, we will cover networking. The reason we do things this way is because it seperates the complexity so that we aren‚Äôt troubleshooting HTTP <strong>AND</strong> networking at the same time. Once we have the ‚Äúlanguage‚Äù (protocol) we‚Äôre going to talk in, then we‚Äôll focus on how to ‚Äúspeak‚Äù it (send network requests).</p>
<p>So the series will roughly be in this order for the posts (0 is this post):</p>
<ol start="0">
<li>Getting the project setup; Getting the boring python packaging bits out of the way</li>
<li>Create request and response objects to house our info
<ul>
<li>Status codes</li>
<li>MIME types</li>
</ul>
</li>
<li>Use request and response objects to generate proper request/response headers and content encoding</li>
<li>Implementing the networking portion</li>
<li>Definining a CLI (command line interface); Lets people use our system more easily</li>
</ol>
<h2 id="source-code">Source code</h2>
<p>Each post will be in it‚Äôs own folder in the <a href="https://github.com/Descent098/HHTTPP">git repository</a>. So for example today would be considered post 0, which can be <a href="https://github.com/Descent098/HHTTPP/tree/master/Post%200">found here</a>. Again the code again is not meant to be <strong>the only</strong> way to achieve this, it‚Äôs <strong>a way</strong>!</p>
<h2 id="code-a-long-ness">Code-a-long-ness</h2>
<p>These posts are not meant to be a code-a-long. There is enough detail to understand what needs to be done, and I give you the info about how to approach the problem. Other than that the solutions to how I decided to do it are available, but I do not go line-by-line through the code at any point.</p>
<h3 id="python-syntax">Python syntax</h3>
<p>On top of the usual intermediate to expert python understanding there are a few topics/syntax you may not have encountered you will need to understand to be able to read the code</p>
<h4 id="list-comprehensions">List comprehensions</h4>
<p>A list comprehension syntactically shorter way to produce a list of values with a simple calculation. It is intended to replace the design pattern of:</p>
<ol>
<li>instantiating an empty list</li>
<li>Iterate and store values in the list</li>
<li>return or use list values.</li>
</ol>
<p>For example:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#E1E4E8">result </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [] </span><span style="color:#6A737D"># 1. Initialize empty list</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># 2. Iterate and store values in the list</span></span>
<span class="line"><span style="color:#F97583">for</span><span style="color:#E1E4E8"> number </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">): </span><span style="color:#6A737D"># Square numbers from 0-9 and add them to the result list</span></span>
<span class="line"><span style="color:#E1E4E8">    result.append(number</span><span style="color:#F97583">**</span><span style="color:#79B8FF">2</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(result) </span><span style="color:#6A737D"># 3. Return or use list values</span></span></code></pre>
<p>Can be shortened to:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#E1E4E8">result </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [number </span><span style="color:#F97583">**</span><span style="color:#79B8FF"> 2</span><span style="color:#F97583"> for</span><span style="color:#E1E4E8"> number </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">)] </span><span style="color:#6A737D"># Steps 1-2</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(result) </span><span style="color:#6A737D"># 3. Return or use list values</span></span></code></pre>
<p>which produces:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#E1E4E8">[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">4</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">9</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">16</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">25</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">36</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">49</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">64</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">81</span><span style="color:#E1E4E8">]</span></span></code></pre>
<p>It does exactly the same as the above example, it is just shorter. The basic syntax is <code>[operation for variable in iterable]</code> Were operation is the calculation (or function) being run, variable is the name for the temporary iteration variable made, and iterable is some form of iterable (list, generator, set etc.). We can also do this conditionally, so for example if we wanted to only include even numbers we could do:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#E1E4E8">evens </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [number </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> number </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">if</span><span style="color:#E1E4E8"> number </span><span style="color:#F97583">%</span><span style="color:#79B8FF">2</span><span style="color:#F97583"> ==</span><span style="color:#79B8FF"> 0</span><span style="color:#E1E4E8">]</span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(evens) </span><span style="color:#6A737D"># [0, 2, 4, 6, 8]</span></span></code></pre>
<p>And we can do an if-else statement using:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#E1E4E8">evens </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#9ECBFF">"even"</span><span style="color:#F97583"> if</span><span style="color:#E1E4E8"> number </span><span style="color:#F97583">%</span><span style="color:#79B8FF">2</span><span style="color:#F97583"> ==</span><span style="color:#79B8FF"> 0</span><span style="color:#F97583"> else</span><span style="color:#9ECBFF"> "odd"</span><span style="color:#F97583"> for</span><span style="color:#E1E4E8"> number </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">)]</span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(evens) </span><span style="color:#6A737D"># ['even', 'odd', 'even', 'odd', 'even', 'odd', 'even', 'odd', 'even', 'odd']</span></span></code></pre>
<h4 id="type-hints">Type hints</h4>
<p>Type hints are a way in python to specify the <strong>intended</strong> type of a variable (not enforced just highly suggested). This works by having a colon, then the type declaration for each varaible/parameter/attribute. You can even include details about return types in functions with <code>def function_name(parameter) -> return_type</code> For example:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#E1E4E8">age </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 21</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> greet</span><span style="color:#E1E4E8">(name):</span></span>
<span class="line"><span style="color:#F97583">   return</span><span style="color:#F97583"> f</span><span style="color:#9ECBFF">"Hello </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">name</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">class</span><span style="color:#B392F0"> Animal</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#F97583">   def</span><span style="color:#79B8FF"> __init__</span><span style="color:#E1E4E8">(self, name):</span></span>
<span class="line"><span style="color:#79B8FF">      self</span><span style="color:#E1E4E8">.name </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> name</span></span></code></pre>
<p>Can be converted to:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#E1E4E8">age:</span><span style="color:#79B8FF">int</span><span style="color:#F97583"> =</span><span style="color:#79B8FF"> 21</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> greet</span><span style="color:#E1E4E8">(name:</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">) -> </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#F97583">   return</span><span style="color:#F97583"> f</span><span style="color:#9ECBFF">"Hello </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">name</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">class</span><span style="color:#B392F0"> Animal</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#F97583">   def</span><span style="color:#79B8FF"> __init__</span><span style="color:#E1E4E8">(self, name:</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#79B8FF">      self</span><span style="color:#E1E4E8">.name:</span><span style="color:#79B8FF">str</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> name</span></span></code></pre>
<p>This gives an indication to people running your code which data types they should use. Along with this there are a few special types to keep in mind (most need to be imported from the typing module):</p>



































<table><thead><tr><th>Type</th><th>Usage</th><th>Example</th></tr></thead><tbody><tr><td>Union</td><td>To indicate one type <strong>OR</strong> another</td><td>A variable called age which can be a string or int could be given as <code>age:Union[str,int] = "Twenty Three"</code></td></tr><tr><td>Literal</td><td>The avlue for the variable is literally one of the subscripted values</td><td>x is 2, 4 or 6 <strong>only</strong> <code>x:Literal[2,4,6]</code></td></tr><tr><td>Tuple</td><td>A tuple is an imutable data type similar to a list, this can mean a tuple, or is used to indicate multiple return values</td><td>The function <code>func()</code> returns an int and a bool in that order <code>def func() -> Tuple[int, bool</code></td></tr><tr><td>List</td><td>A list is a collection. Collections can be subscripted to tell you what‚Äôs inside</td><td>users is a list of list of strings <code>users:List[List[str]] = [["kieran"],["James"]]</code></td></tr><tr><td>Callable</td><td>This means any object that has a <code>__call__()</code> method including functions (yes they are objects)</td><td>Passing the function <code>do_stuff()</code> to <code>time(func:Callable)</code> so it can run it and time it <code>time(do_stuff)</code></td></tr></tbody></table>
<h4 id="dataclasses">Dataclasses</h4>
<p>Dataclasses are a special way to define classes in python. They help make classes more efficient, but have some caveats (that I find are positives), namely all your attributes must be defined with type hints. For example here is a <code>User</code> class the typical python way:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#F97583">class</span><span style="color:#B392F0"> User</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#F97583">   def</span><span style="color:#79B8FF"> __init__</span><span style="color:#E1E4E8">(self, name, age, birthday):</span></span>
<span class="line"><span style="color:#79B8FF">      self</span><span style="color:#E1E4E8">.name </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> name</span></span>
<span class="line"><span style="color:#79B8FF">      self</span><span style="color:#E1E4E8">.age </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> age</span></span>
<span class="line"><span style="color:#79B8FF">      self</span><span style="color:#E1E4E8">.birthday </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> birthday</span></span></code></pre>
<p>Now here is the same class in a dataclass:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> datetime </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> datetime</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> dataclasses </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> dataclass</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">@dataclass</span></span>
<span class="line"><span style="color:#F97583">class</span><span style="color:#B392F0"> User</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">      name: </span><span style="color:#79B8FF">str</span></span>
<span class="line"><span style="color:#E1E4E8">      age:</span><span style="color:#79B8FF">int</span></span>
<span class="line"><span style="color:#E1E4E8">      birthday:datetime</span></span></code></pre>
<p>The handy thing about this is that the birthday attribute was not clear in the original example. It could have been a 3 value tuple for year, month, day (<code>(1998,10,28)</code>), a formatted string <code>"28-10-1998"</code> or any other types. But now users know what type they <strong>should use</strong> (this is not enforced).</p>
<p>If you need to run code after a class instance is created you can use <code>__post_init__(self)</code>.</p>
<h4 id="lambdas">Lambdas</h4>
<p>Lambdas are a way in python to declare anonymous functions. What this means is you can assign a function call to a variable. So for example let‚Äôs take the simplest case, a function that takes in a name and returns a greeting string using the name:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> generate_greeting</span><span style="color:#E1E4E8">(name: </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#F97583">   return</span><span style="color:#F97583"> f</span><span style="color:#9ECBFF">"Hello </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">name</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span></span></code></pre>
<p>We can make this a lambda like this:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#E1E4E8">generate_greeting </span><span style="color:#F97583">=</span><span style="color:#F97583"> lambda</span><span style="color:#E1E4E8"> name: </span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"Hello </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">name</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span></span></code></pre>
<p>Lambdas follow the form of:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#F97583">lambda</span><span style="color:#E1E4E8"> arguments: </span><span style="color:#6A737D"># Function body</span></span></code></pre>
<p>Lambdas always return whatever value is evaluated in the function body. So since we evaluated the string, we get the string back at the end. We can then call it the same way:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#E1E4E8">generate_greeting(</span><span style="color:#9ECBFF">"Kieran"</span><span style="color:#E1E4E8">) </span><span style="color:#6A737D"># "Hello Kieran"</span></span></code></pre>
<p>This comes in handy in cases where something needs a <code>Callable</code> objet, but you don‚Äôt need to call it more than once. One example of this is in dataclasses. For some data types (like <code>List</code>s) you need to provide a <code>Callable</code> object (object with a <code>__call__()</code> funtion) to initialize an attribute that is a list. So you can do this with a lambda that returns an empty list like so:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> dataclasses </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> dataclass, field</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">empty_list </span><span style="color:#F97583">=</span><span style="color:#F97583"> lambda</span><span style="color:#E1E4E8"> : []</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">@dataclass</span></span>
<span class="line"><span style="color:#F97583">class</span><span style="color:#B392F0"> Student</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">   grades:List[</span><span style="color:#79B8FF">int</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> field(</span><span style="color:#FFAB70">default_factory</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">empty_list) </span><span style="color:#6A737D"># Initialize Student.grades to an empty list</span></span></code></pre>
<h2 id="project-setup">Project setup</h2>
<p>For the rest of this post we are just going to setup our code, and talk about how the code is setup. We need to get some of the boring stuff out of the way first. I want to create this project so it can be installed and messed with easily. With python you install packages with pip.</p>
<h3 id="how-pip-works">How pip works</h3>
<p>Pip works with specially formatted python packages to install them to be used on your system. These packages can be stored locally and installed from source files (projects that have a <code>setup.py</code>), or they can be installed remotely from <a href="https://pypi.org/">pypi</a>.</p>
<p>This format has a bunch of stuff that goes into it, so instead of going through everything we‚Äôre going to use a template. Specifically we‚Äôre going to use <a href="https://github.com/canadian-coding/python-package-template">this template</a> I created a while back. It‚Äôs a bit older, but works well for projects like this. If you are following along (or just interested), you can either download a zip of the code, or if you have a github account you can copy the files as a template directly by hitting <code>Use this Template</code>:</p>
<p><img src="/tech/blog/hhttpp/package_templates.png" alt=""></p>
<h3 id="customizing-the-template">Customizing the template</h3>
<p>This template gives you <strong>a ton</strong> of features, we don‚Äôt need a bunch, so I‚Äôm going to delete a bunch of the files. After getting rid of them our project looks like this:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span>‚îú‚îÄ‚îÄ üìÅ.github/</span></span>
<span class="line"><span>‚îÇ   ‚îî‚îÄ‚îÄ üìÅworkflows/</span></span>
<span class="line"><span>‚îÇ       ‚îú‚îÄ‚îÄ üìÉrelease.yml</span></span>
<span class="line"><span>‚îÇ       ‚îî‚îÄ‚îÄ üìÉtest-suite.yml</span></span>
<span class="line"><span>‚îú‚îÄ‚îÄ üìÅhhttpp/</span></span>
<span class="line"><span>‚îÇ   ‚îú‚îÄ‚îÄ üìÑ__init__.py</span></span>
<span class="line"><span>‚îÇ   ‚îú‚îÄ‚îÄ üìÑ__main__.py</span></span>
<span class="line"><span>‚îÇ   ‚îú‚îÄ‚îÄ üìÑclasses.py</span></span>
<span class="line"><span>‚îÇ   ‚îî‚îÄ‚îÄ üìÑcli.py</span></span>
<span class="line"><span>‚îú‚îÄ‚îÄ üìÅtests/</span></span>
<span class="line"><span>‚îÇ   ‚îî‚îÄ‚îÄ üìÑclasses_test.py</span></span>
<span class="line"><span>‚îú‚îÄ‚îÄ üóã.gitignore</span></span>
<span class="line"><span>‚îú‚îÄ‚îÄ üìÉREADME.md</span></span>
<span class="line"><span>‚îî‚îÄ‚îÄ üìÑsetup.py</span></span></code></pre>
<p>So a quick breakdown for now we won‚Äôt need to worry about <code>üìÅ.github/</code>, <code>üìÅtests/</code>, or <code>üóã.gitignore</code>.</p>
<p>So to start with <code>üìÑsetup.py</code> is the file where we will configure our project so it can be installed and how python should treat it when it‚Äôs installed. We won‚Äôt need to touch this file anymore after the initial setup!</p>
<p>Now onto the good stuff. <code>üìÅhhttpp/</code> contains all the code that will be part of our package. We have 4 files inside:</p>
<ul>
<li>üìÑ__init__.py; Just a required file to be able to install the package, there‚Äôs nothing in there except a version indicaor</li>
<li>üìÑ__main__.py; Allows people to run the server using <code>python -m hhttpp</code></li>
<li>üìÑclasses.py; Contains our classes that define our HTTP server</li>
<li>üìÑcli.py; Will be filled out later, but will contain code to let people use the CLI</li>
</ul>
<p>This sets us up well for being able to start building our package!</p>
<p><a class="btn bg-violet-700 hover:bg-violet-500 text-white font-bold py-2 px-4 border border-violet-700 rounded" href="https://kieranwood.ca/tech/blog/setting-up-http-protocol/" target="_blank">Next post!</a></p>  </article> </main> <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js" integrity="sha256-mm3Re3y7xlvh+yCD+l/Zs1d+PU0AEad93MkWvljfm/s=" crossorigin="anonymous"></script>   </main> </div> <footer class="footer footer-center block mb-5 pt-10"> <div class="pb-2">
&copy; 2025 Kieran Wood
</div> <div class="inline opacity-75"> <!-- Thanks for using this template. You can keep this line to support my work :) --> <a href="https://astrofy-template.netlify.app/" target="_blank" class="font-bold">Astrofy Template</a> developed by
<a href="https://manuelernestog.github.io" target="_blank" class="font-bold">Manuel Ernesto ‚ö°Ô∏è</a> </div> </footer>  </div> <div class="drawer-side z-40"> <label for="my-drawer" class="drawer-overlay"></label> <aside class="px-2 pt-2 h-auto min-h-full w-[19rem] bg-base-200 text-base-content flex flex-col"> <div class="w-fit mx-auto mt-5 mb-6"> <a href="/"> <div class="avatar transition ease-in-out hover:scale-[102%] block m-auto"> <div class="w-[8.5rem]"> <img src="/tech/profile.jpg" class="mask mask-circle" alt="Profile image" width="300" height="300" loading="lazy" decoding="async"> </div> </div> </a> </div> <ul class="menu grow shrink menu-md overflow-y-auto"> <li><a class="py-3 text-base" id="home" href="/tech/">Home</a></li> <li><a class="py-3 text-base" id="projects" href="/tech/projects">Projects</a></li> <!-- <li><a class="py-3 text-base" id="services" href="/tech/services">Services</a></li>
    <li><a class="py-3 text-base" id="store" href="/tech/store">Store</a></li> --> <li><a class="py-3 text-base" id="blog" href="/tech/blog/">Blog</a></li> <li><a class="py-3 text-base" id="cv" href="/tech/cv">CV</a></li> <li><a class="py-3 text-base" href="/tech/contact">Contact</a></li> </ul> <script>(function(){const sideBarActiveItemID = undefined;
const activeClass = "bg-base-300";

const activeItemElem = document.getElementById(sideBarActiveItemID);
activeItemElem && activeItemElem.classList.add(activeClass);
})();</script> <div class="block sticky pointer-events-none bottom-10 bg-base-200 justify-center h-12 [mask-image:linear-gradient(transparent,#000000)]"></div> <div class="social-icons px-4 pb-5 pt-1 flex self-center justify-center sticky bottom-0 bg-base-200"> <a href="https://github.com/descent098" target="_blank" class="mx-3" aria-label="Github" title="Github"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" style="fill: currentColor;transform: ;msFilter:;"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.026 2c-5.509 0-9.974 4.465-9.974 9.974 0 4.406 2.857 8.145 6.821 9.465.499.09.679-.217.679-.481 0-.237-.008-.865-.011-1.696-2.775.602-3.361-1.338-3.361-1.338-.452-1.152-1.107-1.459-1.107-1.459-.905-.619.069-.605.069-.605 1.002.07 1.527 1.028 1.527 1.028.89 1.524 2.336 1.084 2.902.829.091-.645.351-1.085.635-1.334-2.214-.251-4.542-1.107-4.542-4.93 0-1.087.389-1.979 1.024-2.675-.101-.253-.446-1.268.099-2.64 0 0 .837-.269 2.742 1.021a9.582 9.582 0 0 1 2.496-.336 9.554 9.554 0 0 1 2.496.336c1.906-1.291 2.742-1.021 2.742-1.021.545 1.372.203 2.387.099 2.64.64.696 1.024 1.587 1.024 2.675 0 3.833-2.33 4.675-4.552 4.922.355.308.675.916.675 1.846 0 1.334-.012 2.41-.012 2.737 0 .267.178.577.687.479C19.146 20.115 22 16.379 22 11.974 22 6.465 17.535 2 12.026 2z"></path> </svg> </a> <a href="https://www.linkedin.com/in/kieran-wood" target="_blank" class="mx-3" aria-label="Linkedin" title="Linkedin"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" style="fill: currentColor;transform: ;msFilter:;"><circle cx="4.983" cy="5.009" r="2.188"></circle><path d="M9.237 8.855v12.139h3.769v-6.003c0-1.584.298-3.118 2.262-3.118 1.937 0 1.961 1.811 1.961 3.218v5.904H21v-6.657c0-3.27-.704-5.783-4.526-5.783-1.835 0-3.065 1.007-3.568 1.96h-.051v-1.66H9.237zm-6.142 0H6.87v12.139H3.095z"></path> </svg> </a> <a href="https://instagram.com/descent098" target="_blank" class="mx-3" aria-label="Instagram" title="Instagram"> <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 -5 24 24" style="fill: currentColor;transform: ;msFilter:;"><path d="M8 0C5.829 0 5.556.01 4.703.048 3.85.088 3.269.222 2.76.42a3.917 3.917 0 0 0-1.417.923A3.927 3.927 0 0 0 .42 2.76C.222 3.268.087 3.85.048 4.7.01 5.555 0 5.827 0 8.001c0 2.172.01 2.444.048 3.297.04.852.174 1.433.372 1.942.205.526.478.972.923 1.417.444.445.89.719 1.416.923.51.198 1.09.333 1.942.372C5.555 15.99 5.827 16 8 16s2.444-.01 3.298-.048c.851-.04 1.434-.174 1.943-.372a3.916 3.916 0 0 0 1.416-.923c.445-.445.718-.891.923-1.417.197-.509.332-1.09.372-1.942C15.99 10.445 16 10.173 16 8s-.01-2.445-.048-3.299c-.04-.851-.175-1.433-.372-1.941a3.926 3.926 0 0 0-.923-1.417A3.911 3.911 0 0 0 13.24.42c-.51-.198-1.092-.333-1.943-.372C10.443.01 10.172 0 7.998 0h.003zm-.717 1.442h.718c2.136 0 2.389.007 3.232.046.78.035 1.204.166 1.486.275.373.145.64.319.92.599.28.28.453.546.598.92.11.281.24.705.275 1.485.039.843.047 1.096.047 3.231s-.008 2.389-.047 3.232c-.035.78-.166 1.203-.275 1.485a2.47 2.47 0 0 1-.599.919c-.28.28-.546.453-.92.598-.28.11-.704.24-1.485.276-.843.038-1.096.047-3.232.047s-2.39-.009-3.233-.047c-.78-.036-1.203-.166-1.485-.276a2.478 2.478 0 0 1-.92-.598 2.48 2.48 0 0 1-.6-.92c-.109-.281-.24-.705-.275-1.485-.038-.843-.046-1.096-.046-3.233 0-2.136.008-2.388.046-3.231.036-.78.166-1.204.276-1.486.145-.373.319-.64.599-.92.28-.28.546-.453.92-.598.282-.11.705-.24 1.485-.276.738-.034 1.024-.044 2.515-.045v.002zm4.988 1.328a.96.96 0 1 0 0 1.92.96.96 0 0 0 0-1.92zm-4.27 1.122a4.109 4.109 0 1 0 0 8.217 4.109 4.109 0 0 0 0-8.217zm0 1.441a2.667 2.667 0 1 1 0 5.334 2.667 2.667 0 0 1 0-5.334"></path> </svg> </a> <a href="/rss.xml" target="_blank" class="mx-3" aria-label="RSS Feed" title="RSS Feed"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" style="fill: currentColor;transform: ;msFilter:;"><path d="M19 20.001C19 11.729 12.271 5 4 5v2c7.168 0 13 5.832 13 13.001h2z"></path><path d="M12 20.001h2C14 14.486 9.514 10 4 10v2c4.411 0 8 3.589 8 8.001z"></path><circle cx="6" cy="18" r="2"></circle> </svg> </a> </div> </aside> </div> </div> </body></html>