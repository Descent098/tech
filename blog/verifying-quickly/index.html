<!DOCTYPE html><html lang="en" data-theme="lofi"> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/jpeg" href="/tech/profile.jpg"><meta name="generator" content="Astro v5.17.2"><!-- Primary Meta Tags --><title>How to verify quickly | Kieran Wood</title><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><script type="module" src="/tech/_astro/ClientRouter.astro_astro_type_script_index_0_lang.CDGfc0hd.js"></script><meta name="title" content="How to verify quickly"><meta name="description" content="How hashing works, and what we use it for when developing applications simply"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://kieranwood.ca/tech/blog/verifying-quickly/"><meta property="og:title" content="How to verify quickly"><meta property="og:description" content="How hashing works, and what we use it for when developing applications simply"><meta property="og:image" content="https://kieranwood.ca/tech/blog/hashing/hero.jpeg"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://kieranwood.ca/tech/blog/verifying-quickly/"><meta property="twitter:title" content="How to verify quickly"><meta property="twitter:description" content="How hashing works, and what we use it for when developing applications simply"><meta property="twitter:image" content="https://kieranwood.ca/tech/blog/hashing/hero.jpeg"><link rel="stylesheet" href="/tech/_astro/_page_.7orOsfmi.css">
<style>.time-line-container>div:last-child .education__time>.education__line{display:none}details{background:#f0f0f0;padding:1rem;border-radius:.7rem;margin:.5rem auto;width:100%}summary{cursor:pointer}#TOC-list{list-style:none}#TOC-list li{margin-top:.15rem}.danger-banner{display:flex;flex-direction:row;background:#f44336;border-radius:.25rem;padding:1.1rem;color:#fff!important;flex-wrap:wrap}.danger-banner strong,.danger-banner a{color:#fff!important}.danger-banner:before{content:"!üõë Danger üõë!";flex-basis:100%;margin-bottom:.5rem;padding:.6rem;border-radius:.25rem;text-align:center;background:red;text-transform:uppercase}.warning-banner{display:flex;flex-direction:row;background:#fcc51e;border-radius:.25rem;padding:1.1rem;color:#141414!important;flex-wrap:wrap}.warning-banner strong,.warning-banner a{color:#141414!important}.warning-banner:before{content:"üü° Warning üü°";flex-basis:100%;margin-bottom:.5rem;padding:.6rem;border-radius:.25rem;text-align:center;background:#f6cb49;text-transform:uppercase;text-shadow:1px 1px 1px rgb(93,93,93)}.level-3{text-indent:1rem}.level-4{text-indent:2rem}.level-5{text-indent:3rem}.level-6{text-indent:4rem}.astro-route-announcer{position:absolute;left:0;top:0;clip:rect(0 0 0 0);clip-path:inset(50%);overflow:hidden;white-space:nowrap;width:1px;height:1px}
@keyframes astroFadeInOut{0%{opacity:1}to{opacity:0}}@keyframes astroFadeIn{0%{opacity:0;mix-blend-mode:plus-lighter}to{opacity:1;mix-blend-mode:plus-lighter}}@keyframes astroFadeOut{0%{opacity:1;mix-blend-mode:plus-lighter}to{opacity:0;mix-blend-mode:plus-lighter}}@keyframes astroSlideFromRight{0%{transform:translate(100%)}}@keyframes astroSlideFromLeft{0%{transform:translate(-100%)}}@keyframes astroSlideToRight{to{transform:translate(100%)}}@keyframes astroSlideToLeft{to{transform:translate(-100%)}}@media(prefers-reduced-motion){::view-transition-group(*),::view-transition-old(*),::view-transition-new(*){animation:none!important}[data-astro-transition-scope]{animation:none!important}}
</style><style>[data-astro-transition-scope="astro-vz7ejtmd-1"] { view-transition-name: __2ftech_2fblog_2fhashing_2fhero_2ejpeg; }</style><style>[data-astro-transition-scope="astro-frvnq75b-2"] { view-transition-name: How_20to_20verify_20quickly; }</style></head> <body> <div class="bg-base-100 drawer lg:drawer-open"> <input id="my-drawer" type="checkbox" class="drawer-toggle"> <div class="drawer-content bg-base-100"> <div class="sticky lg:hidden top-0 z-30 flex h-16 w-full justify-center bg-opacity-90 backdrop-blur transition-all duration-100 bg-base-100 text-base-content shadow-sm"> <div class="navbar"> <div class="navbar-start"> <label for="my-drawer" class="btn btn-square btn-ghost"> <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block w-5 h-5 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path> </svg> </label> </div> <div class="navbar-center"> <a class="btn btn-ghost normal-case text-xl" href="/">Kieran Wood ‚ö°Ô∏è</a> </div> <div class="navbar-end"></div> </div> </div> <div class="md:flex md:justify-center"> <main class="p-6 pt-10 lg:max-w-[900px] max-w-[100vw]">  <main class="md:flex md:justify-center"> <article class="prose prose-lg max-w-[750px] prose-img:mx-auto"> <img src="/tech/blog/hashing/hero.jpeg" alt="How to verify quickly" style="border-radius:.5em" data-astro-transition-scope="astro-vz7ejtmd-1" loading="lazy" decoding="async" fetchpriority="auto" width="750" height="422" class="w-full mb-6"> <h1 class="title my-2 text-4xl font-bold" data-astro-transition-scope="astro-frvnq75b-2">How to verify quickly</h1> <time>Jul 31, 2023</time> <br>  <a href="/tech/blog/tag/optimization" class="badge badge-outline ml-2 no-underline"> optimization </a><a href="/tech/blog/tag/theory" class="badge badge-outline ml-2 no-underline"> theory </a><a href="/tech/blog/tag/terminology" class="badge badge-outline ml-2 no-underline"> terminology </a>  <p class="text-lg text-italics">Crossposted from <a class="text-violet-700" target="_blank" href="https://schulichignite.com/blog/verifying-quickly/">https://schulichignite.com/blog/verifying-quickly/</a></p> <div class="divider my-2"></div> <div> <h2>Table of contents</h2> <ul id="TOC-list"> <li class="level-2"> <a href="#a-custom-hashing-algorithm" class="no-underline"> A Custom Hashing Algorithm </a> </li><li class="level-2"> <a href="#a-password-system" class="no-underline"> A Password System </a> </li><li class="level-2"> <a href="#hashtable" class="no-underline"> HashTable </a> </li><li class="level-2"> <a href="#sub-resource-integrity" class="no-underline"> Sub-Resource Integrity </a> </li><li class="level-2"> <a href="#conclusion" class="no-underline"> Conclusion </a> </li> </ul> </div>
  <hr><p><a href="/definitions/hashing">Hashing</a> is an incredibly important concept in computer science. It‚Äôs used in everyting from validation to speeding up our data lookups. If you haven‚Äôt yet please read our <a href="/definitions/hashing">definition of hashing</a>, this will cover the base concepts used in this article, and will go into some of these use cases in more detail.</p>
<p>The focus on this article will be starting from scratch to create a hashing algorithm which can then be used in 3 use cases:</p>
<ol>
<li>As a password storage and validation system</li>
<li>To create a <a href="https://en.wikipedia.org/wiki/Hash_table#:~:text=It%20is%20an%20abstract%20data,the%20corresponding%20value%20is%20stored.">HashTable</a></li>
<li>To do <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Subresource_Integrity">subresource integrity</a> from scratch</li>
</ol>
<p>You can find a full copy of the source code for this article <a href="https://github.com/descent098/hashing">here</a>.</p>
<h2 id="a-custom-hashing-algorithm">A Custom Hashing Algorithm</h2>
<p>As we talked about in the <a href="/definitions/hashing">definition of hashing</a>, hash functions have a few properties we want:</p>
<ol>
<li>Take in an input of arbitrary length</li>
<li>Create a unique sequence for each input (1 input to 1 output ideally)</li>
<li>Ideally have fixed-length output (this is nice for certain systems)</li>
</ol>
<p>With these in mind we can create a simple hashing function with a few steps:</p>
<ol>
<li>Convert the input value to string if it‚Äôs another data type</li>
<li>Start with the number 1, for each character in the input multiply the current hash by the index of the character in the following lokoup table:</li>
</ol>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#79B8FF">ASCII_TABLE</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> [</span><span style="color:#9ECBFF">'0'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'1'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'2'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'3'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'4'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'5'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'6'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'7'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'8'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'9'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'a'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'b'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'c'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'d'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'e'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'f'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'g'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'h'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'i'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'j'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'k'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'l'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'m'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'n'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'o'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'p'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'q'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'r'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'s'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'t'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'u'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'v'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'w'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'x'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'y'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'z'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'A'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'B'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'C'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'D'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'E'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'F'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'G'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'H'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'I'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'J'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'K'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'L'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'M'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'N'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'O'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'P'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Q'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'R'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'S'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'T'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'U'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'V'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'W'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'X'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Y'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'Z'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'!'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'"'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'#'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'$'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'%'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'&#x26;'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"'"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'('</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">')'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'*'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'+'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">','</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'-'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'.'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'/'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">':'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">';'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'&#x3C;'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'='</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'>'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'?'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'@'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'['</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'</span><span style="color:#79B8FF">\\</span><span style="color:#9ECBFF">'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">']'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'^'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'_'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'`'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'{'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'|'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'}'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'~'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">' '</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'</span><span style="color:#79B8FF">\t</span><span style="color:#9ECBFF">'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'</span><span style="color:#79B8FF">\n</span><span style="color:#9ECBFF">'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'</span><span style="color:#79B8FF">\r</span><span style="color:#9ECBFF">'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'</span><span style="color:#79B8FF">\x0b</span><span style="color:#9ECBFF">'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'</span><span style="color:#79B8FF">\x0c</span><span style="color:#9ECBFF">'</span><span style="color:#E1E4E8">]</span></span></code></pre>
<ol start="3">
<li>Fix the length of the output to 128 characters.
<ul>
<li>If the resulting hash is less than 128 characters take the difference between the current length of hash and 128, for each of those characters append the character at the index of the current loop itteration in the lookup table (see below for example)</li>
<li>if longer truncate to the first 128 characers</li>
</ul>
</li>
</ol>
<p>For example if you had a hash with 126 characters then the loop would start ‚Äò0‚Äô would be appended to end of current hash, then on next itteration ‚Äò1‚Äô would be appended. Leaving us with <code>&#x3C;current_hash>10</code> to pad it to 128. Since we want exactly 128 characters we go to 9, then strip the digit for every digit added (i.e. 101 would become 1, and 20 would become 0)</p>
<p>Here is the full code:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> sys</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> typing </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> Union, Tuple</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> string </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> printable </span><span style="color:#F97583">as</span><span style="color:#79B8FF"> ASCII_TABLE</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">sys.set_int_max_str_digits(</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">) </span><span style="color:#6A737D"># Disable string conversion length limit in python</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> hash_function</span><span style="color:#E1E4E8">(value:Union[</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">int</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">float</span><span style="color:#E1E4E8">, Tuple]) -> </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#6A737D">    # Hashes a provided value</span></span>
<span class="line"><span style="color:#E1E4E8">    value </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> str</span><span style="color:#E1E4E8">(value) </span><span style="color:#6A737D"># Make sure value is a string</span></span>
<span class="line"><span style="color:#79B8FF">    hash</span><span style="color:#F97583"> =</span><span style="color:#79B8FF"> 1</span><span style="color:#6A737D"> # Start hash at 1 or else every multiplication would result in 0</span></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#E1E4E8"> character </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> value: </span><span style="color:#6A737D"># Multiply each character by ascii value to current hash</span></span>
<span class="line"><span style="color:#79B8FF">        hash</span><span style="color:#F97583"> *=</span><span style="color:#79B8FF"> ASCII_TABLE</span><span style="color:#E1E4E8">.index(character)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF">    hash</span><span style="color:#F97583"> =</span><span style="color:#79B8FF"> str</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">hash</span><span style="color:#E1E4E8">) </span><span style="color:#6A737D"># Convert hash back to a string</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#79B8FF"> len</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">hash</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">&#x3C;</span><span style="color:#79B8FF"> 128</span><span style="color:#E1E4E8">: </span><span style="color:#6A737D"># Too short, need to pad hash</span></span>
<span class="line"><span style="color:#F97583">        for</span><span style="color:#E1E4E8"> number </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">128</span><span style="color:#F97583">-</span><span style="color:#79B8FF">len</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">hash</span><span style="color:#E1E4E8">)):</span></span>
<span class="line"><span style="color:#F97583">            if</span><span style="color:#E1E4E8"> number </span><span style="color:#F97583">></span><span style="color:#79B8FF"> 99</span><span style="color:#E1E4E8">: </span><span style="color:#6A737D"># Only single digit values allowed</span></span>
<span class="line"><span style="color:#E1E4E8">                number </span><span style="color:#F97583">//=</span><span style="color:#79B8FF"> 100</span></span>
<span class="line"><span style="color:#F97583">            elif</span><span style="color:#E1E4E8"> number </span><span style="color:#F97583">></span><span style="color:#79B8FF"> 9</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">                number </span><span style="color:#F97583">//=</span><span style="color:#79B8FF">10</span></span>
<span class="line"><span style="color:#79B8FF">            hash</span><span style="color:#F97583"> +=</span><span style="color:#79B8FF"> str</span><span style="color:#E1E4E8">(number)</span></span>
<span class="line"><span style="color:#F97583">    elif</span><span style="color:#79B8FF"> len</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">hash</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">></span><span style="color:#79B8FF"> 128</span><span style="color:#E1E4E8">: </span><span style="color:#6A737D"># Too long, need to truncate hash</span></span>
<span class="line"><span style="color:#79B8FF">        hash</span><span style="color:#F97583"> =</span><span style="color:#79B8FF"> hash</span><span style="color:#E1E4E8">[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">:</span><span style="color:#79B8FF">128</span><span style="color:#E1E4E8">]</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#79B8FF"> int</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">hash</span><span style="color:#E1E4E8">)</span></span></code></pre>
<p>With these in mind the you want a hashing algorithm to avoid collisions. Collisions happen when more than 1 item results in the same output hash. This creates lots of problems in tons of different ways, and should be avoided‚Ä¶</p>
<p>Our hashing algorithm will have quite a few collisions. This could actually be avoided by changing a few things, but I wanted collisions to be easy to generate so for the HashTable we can measure how much of a performance hit it causes (that‚Äôs my excuse and I‚Äôm sticking to it)!</p>
<p>Specifically our hashing algorithm will create collisions on any anagrams (words created from same letters i.e. race and care have the same letters [‚Äúa‚Äù, ‚Äúc‚Äù, ‚Äúe‚Äù, ‚Äúr‚Äù]). This is because the multiplication of the ASCII values will be the same since it doesn‚Äôt matter which order numbers are in for multiplication. We could for example have made an algorithm that divides until the value is less than 1, then bit-shift right the resulting floating point number by 128 bits, and strip the remainder, this would give us less collisions. Feel free to try implementing it yourself.</p>
<h2 id="a-password-system">A Password System</h2>
<p>Now we have a hashing algorithm we can start by creating a system for users to login with. There are tons of ways to do this. For us we‚Äôre going to create a <code>User</code> object, that stores the users information, and we will keep a list of <code>User</code>‚Äôs to act as a ‚Äúdatabase‚Äù for people to login to.</p>
<p>So in our case we setup our salt and pepper:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#79B8FF">SALT</span><span style="color:#F97583"> =</span><span style="color:#9ECBFF"> "%^&#x26;(!%#@@#$&#x26;$@&#x26;#!^%)"</span></span>
<span class="line"><span style="color:#79B8FF">PEPPER</span><span style="color:#F97583"> =</span><span style="color:#9ECBFF"> "!@^%@#&#x26;#@#(@*&#x26;@%&#x26;)"</span></span></code></pre>
<p>Then our <code>User</code> class is:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> dataclasses </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> dataclass</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">@dataclass</span></span>
<span class="line"><span style="color:#F97583">class</span><span style="color:#B392F0"> User</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">    name: </span><span style="color:#79B8FF">str</span></span>
<span class="line"><span style="color:#E1E4E8">    username:</span><span style="color:#79B8FF">str</span></span>
<span class="line"><span style="color:#E1E4E8">    email:</span><span style="color:#79B8FF">str</span></span>
<span class="line"><span style="color:#E1E4E8">    age: </span><span style="color:#79B8FF">int</span></span>
<span class="line"><span style="color:#E1E4E8">    password: </span><span style="color:#79B8FF">str</span></span></code></pre>
<p>Which we then have a ‚Äúdatabase‚Äù called users which we will add to as users sign up:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#E1E4E8">users </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span></span>
<span class="line"><span style="color:#E1E4E8">    User(</span><span style="color:#9ECBFF">"Kieran"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"descent098"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"kieran@kieranwood.ca"</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">24</span><span style="color:#E1E4E8">, hash_function(</span><span style="color:#79B8FF">PEPPER</span><span style="color:#F97583"> +</span><span style="color:#9ECBFF"> "you'll_never_guess_my_password"</span><span style="color:#F97583"> +</span><span style="color:#79B8FF"> SALT</span><span style="color:#E1E4E8">))</span></span>
<span class="line"><span style="color:#E1E4E8">]</span></span></code></pre>
<p>We can now create our <code>signup()</code> and <code>login()</code> functions:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#6A737D"># Import hash function we wrote</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> hashing </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> hash_function</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> signup</span><span style="color:#E1E4E8">(name:</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">, username:</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">, email:</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">, age:</span><span style="color:#79B8FF">int</span><span style="color:#E1E4E8">, password:</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#6A737D">    # Lets you create a new user</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    # Format the password properly</span></span>
<span class="line"><span style="color:#E1E4E8">    password </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> PEPPER</span><span style="color:#F97583"> +</span><span style="color:#E1E4E8"> password </span><span style="color:#F97583">+</span><span style="color:#79B8FF"> SALT</span><span style="color:#6A737D"> # Add salt and pepper to password</span></span>
<span class="line"><span style="color:#E1E4E8">    password </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> hash_function(password) </span><span style="color:#6A737D"># Hash password</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#E1E4E8"> user </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> users: </span><span style="color:#6A737D"># Make sure user doesn't exist already</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> user.username </span><span style="color:#F97583">==</span><span style="color:#E1E4E8"> username:</span></span>
<span class="line"><span style="color:#F97583">            raise</span><span style="color:#79B8FF"> ValueError</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"User with username: </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">username</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF"> already exists"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#6A737D">    # Update the global "database" (just a variable in our case)</span></span>
<span class="line"><span style="color:#E1E4E8">    users.append(User(name, username, email, age, password))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> login</span><span style="color:#E1E4E8">(username:</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">, password:</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">) -> User:</span></span>
<span class="line"><span style="color:#6A737D">    # Allows a user to login</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#6A737D">    # Format password</span></span>
<span class="line"><span style="color:#E1E4E8">    password </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> PEPPER</span><span style="color:#F97583"> +</span><span style="color:#E1E4E8"> password </span><span style="color:#F97583">+</span><span style="color:#79B8FF"> SALT</span><span style="color:#6A737D"> # Add salt and pepper to password</span></span>
<span class="line"><span style="color:#E1E4E8">    password </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> hash_function(password) </span><span style="color:#6A737D"># Hash password</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#E1E4E8"> user </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> users: </span><span style="color:#6A737D"># Look for user</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> user.username </span><span style="color:#F97583">==</span><span style="color:#E1E4E8"> username: </span><span style="color:#6A737D"># Found user</span></span>
<span class="line"><span style="color:#F97583">            if</span><span style="color:#E1E4E8"> user.password </span><span style="color:#F97583">==</span><span style="color:#E1E4E8"> password: </span><span style="color:#6A737D"># Correct password</span></span>
<span class="line"><span style="color:#F97583">                return</span><span style="color:#E1E4E8"> user</span></span>
<span class="line"><span style="color:#F97583">            else</span><span style="color:#E1E4E8">: </span><span style="color:#6A737D"># Bad password</span></span>
<span class="line"><span style="color:#F97583">                raise</span><span style="color:#79B8FF"> ValueError</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"Incorrect password for user </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">username</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#6A737D">    # Couldn't find user with specified username</span></span>
<span class="line"><span style="color:#F97583">    raise</span><span style="color:#79B8FF"> ValueError</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"User </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">username</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF"> does not exist"</span><span style="color:#E1E4E8">)</span></span></code></pre>
<p>A few notes about this approach in the real world:</p>
<ul>
<li>You would never really want a salt and pepper so easily accessible in a plaintext file, use something like an <a href="https://medium.com/chingu/an-introduction-to-environment-variables-and-how-to-use-them-f602f66d15fa">environment variable</a> to store the info</li>
<li>Even though they are hashed you want to be careful with allowing anyone the hashed passwords, this approach helps with security, but there are tons of attacks it‚Äôs still vulnerable to</li>
<li>You would want to do the salt and peppering <strong>before</strong> you sent the password to your system, otherwise if someone intercepts the data they have the user‚Äôs plaintext password</li>
<li>It is likely better to use a HashMap or a real database to lookup users, it will be much faster than searching the entire list of users every time</li>
</ul>
<h2 id="hashtable">HashTable</h2>
<p>A HashTable (sometimes called HashMap or Dictionary) is used to create key-value pairs. So instead of list indicies we use key->value pairs, where we can create ‚Äúindicies‚Äù using things like strings. An example would be JSON, or a dictionary in python that looks like this:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#E1E4E8">user </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> {</span><span style="color:#9ECBFF">"name"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"Kieran"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"age"</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">24</span><span style="color:#E1E4E8">}</span></span></code></pre>
<p>With this code we can now access the user dictionary, but instead of indicies we use the value to the left of the colon (i.e. ‚Äúname‚Äù, or ‚Äúage‚Äù):</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#E1E4E8">user[</span><span style="color:#9ECBFF">"name"</span><span style="color:#E1E4E8">] </span><span style="color:#6A737D"># "Kieran"</span></span>
<span class="line"><span style="color:#E1E4E8">user[</span><span style="color:#9ECBFF">"age"</span><span style="color:#E1E4E8">] </span><span style="color:#6A737D"># 24</span></span></code></pre>
<p>A much more in-depth look can be found <a href="https://schulichignite.com/definitions/hashing/#hashmapsdictionarieshashtables">here</a>, but basically we‚Äôre going to use our hash function to create a HashTable, which will give us the same functionality as a python dictionary. In order to do this we will need a few classes:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> dataclasses </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> dataclass</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">@dataclass</span></span>
<span class="line"><span style="color:#F97583">class</span><span style="color:#B392F0"> Node</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">    key: </span><span style="color:#79B8FF">str</span></span>
<span class="line"><span style="color:#E1E4E8">    value: Any</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">@dataclass</span></span>
<span class="line"><span style="color:#F97583">class</span><span style="color:#B392F0"> HashTable</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">    buckets: List[List[Node]]</span></span></code></pre>
<p>A node will be where we store the key-value pair, which will then be placed into our buckets list/Array. We also need to decide how many buckets we want, for now we will arbitrarily pick 6 (because it makes the drawings easier üòâ) but we will discuss what more or less buckets does shortly. The basic idea is that we will use a hashing function to generate an index location in the buckets list, we will then insert the node at that index in the buckets list. This means that for searching later we can skip searching all values in any of the other buckets!</p>
<p>So the insertion would take the steps:</p>
<ol>
<li>Create HashTable with 6 empty buckets</li>
<li>Take the key you want to insert and hash it with some algorithm (make sure resulting hash is just numbers)</li>
<li>Take that hash and modulo (divide by and take the remainder) it by the number of buckets (in our case 6)</li>
<li>Create a node which contains the value and the key</li>
<li>Insert the node into the index you calculated from the key</li>
</ol>
<p><img src="/tech/blog/hashing/hashtable-example.png" alt=""></p>
<p>After insertion:</p>
<p><img src="/tech/blog/hashing/ht-2.png" alt=""></p>
<p>For searching/finding we would have the following algorithm:</p>
<ol>
<li>Take the key you want to find and hash it with some algorithm (make sure resulting hash is just numbers)</li>
<li>Take that hash and modulo (divide by and take the remainder) it by the number of buckets (in our case 6)</li>
<li>Look into the <code>HashTable</code> at the given index, if list at index is empty throw an error, if not then go through the list at that index and check each node in the list until you find one with the same key, if you hit the end of the list then throw an error</li>
</ol>
<p>So for steps 1-2:</p>
<p><img src="/tech/blog/hashing/ht-find.png" alt=""></p>
<p>Now we have the index we can do step 3</p>
<p><img src="/tech/blog/hashing/ht-find2.png" alt=""></p>
<p>The code for the whole HashTable can be found here:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> hashing </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> hash_function</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> dataclasses </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> dataclass, field</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> typing </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> Any, List</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># </span><span style="color:#F97583">NOTE</span><span style="color:#6A737D">: HashTables in this example are using 16 buckets, not 6</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">@dataclass</span></span>
<span class="line"><span style="color:#F97583">class</span><span style="color:#B392F0"> Node</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">    key:</span><span style="color:#79B8FF">str</span></span>
<span class="line"><span style="color:#E1E4E8">    value: Any</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">@dataclass</span></span>
<span class="line"><span style="color:#F97583">class</span><span style="color:#B392F0"> HashTable</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#6A737D">    # A standard HashTable to store key-value pairs</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">    buckets:List[List[Node]] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> field(</span><span style="color:#FFAB70">default_factory</span><span style="color:#F97583">=lambda</span><span style="color:#E1E4E8">: [[] </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> _ </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">16</span><span style="color:#E1E4E8">)]) </span><span style="color:#6A737D"># Setup 16 empty "buckets"</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#F97583">    def</span><span style="color:#B392F0"> insert</span><span style="color:#E1E4E8">(self, key:</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">, value:Any):</span></span>
<span class="line"><span style="color:#6A737D">        # Inserts a key-value pair into the buckets</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">        # 2 &#x26; 3 Hash the key and then modulo the result by 16</span></span>
<span class="line"><span style="color:#E1E4E8">        index </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> int</span><span style="color:#E1E4E8">(hash_function(key) </span><span style="color:#F97583">%</span><span style="color:#79B8FF"> 16</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">        </span></span>
<span class="line"><span style="color:#6A737D">        # 4.  Create a node which contains the value and the key</span></span>
<span class="line"><span style="color:#E1E4E8">        new_node </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> Node(key, value)</span></span>
<span class="line"><span style="color:#E1E4E8">        </span></span>
<span class="line"><span style="color:#6A737D">        # 5. Insert the node into the index you calculated from the key</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#79B8FF"> self</span><span style="color:#E1E4E8">.buckets[index]: </span><span style="color:#6A737D">## If the bucket already has values</span></span>
<span class="line"><span style="color:#79B8FF">            self</span><span style="color:#E1E4E8">.buckets[index].append(new_node)</span></span>
<span class="line"><span style="color:#F97583">        else</span><span style="color:#E1E4E8">: </span><span style="color:#6A737D">## If bucket was empty</span></span>
<span class="line"><span style="color:#79B8FF">            self</span><span style="color:#E1E4E8">.buckets[index] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [new_node]</span></span>
<span class="line"><span style="color:#E1E4E8">            </span></span>
<span class="line"><span style="color:#F97583">    def</span><span style="color:#B392F0"> find</span><span style="color:#E1E4E8">(self, key:</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">) -> Any:</span></span>
<span class="line"><span style="color:#6A737D">        # Find a value for a given key</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">        # 1 &#x26; 2 Hash the key and then modulo the result by 16</span></span>
<span class="line"><span style="color:#E1E4E8">        index </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> int</span><span style="color:#E1E4E8">(hash_function(key) </span><span style="color:#F97583">%</span><span style="color:#79B8FF"> 16</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">        </span></span>
<span class="line"><span style="color:#6A737D">        # 3. Look into the bucket at the given index</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#79B8FF"> self</span><span style="color:#E1E4E8">.buckets[index]:</span></span>
<span class="line"><span style="color:#6A737D">            ## 3.1 Check each node in the bucket to find the matching one</span></span>
<span class="line"><span style="color:#F97583">            for</span><span style="color:#E1E4E8"> node </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> self</span><span style="color:#E1E4E8">.buckets[index]:</span></span>
<span class="line"><span style="color:#6A737D">                ## 3.2 The current node matches the key you're looking for</span></span>
<span class="line"><span style="color:#F97583">                if</span><span style="color:#E1E4E8"> node.key </span><span style="color:#F97583">==</span><span style="color:#E1E4E8"> key:</span></span>
<span class="line"><span style="color:#F97583">                    return</span><span style="color:#E1E4E8"> node.value</span></span>
<span class="line"><span style="color:#F97583">            raise</span><span style="color:#79B8FF"> ValueError</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"No value found for key </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">key</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">        else</span><span style="color:#E1E4E8">: </span></span>
<span class="line"><span style="color:#F97583">            raise</span><span style="color:#79B8FF"> ValueError</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"No value found for key </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">key</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span><span style="color:#E1E4E8">)</span></span></code></pre>
<p>We can then test this code with:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#6A737D"># Test original Hash table</span></span>
<span class="line"><span style="color:#E1E4E8">ht </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> HashTable()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">## Make inserts</span></span>
<span class="line"><span style="color:#E1E4E8">ht.insert(</span><span style="color:#9ECBFF">"novelty"</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">ht.insert(</span><span style="color:#9ECBFF">"yeotlvn"</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">11</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">ht.insert(</span><span style="color:#9ECBFF">"voetlny"</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">12</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">ht.insert(</span><span style="color:#9ECBFF">"eoltvyn"</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">13</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">ht.insert(</span><span style="color:#9ECBFF">"asdfgsdfg"</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">## Find</span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(ht.find(</span><span style="color:#9ECBFF">"novelty"</span><span style="color:#E1E4E8">))</span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(ht.find(</span><span style="color:#9ECBFF">"yeotlvn"</span><span style="color:#E1E4E8">))</span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(ht.find(</span><span style="color:#9ECBFF">"eoltvyn"</span><span style="color:#E1E4E8">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">## Check buckets</span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(ht.buckets)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">## Find that doesn't exist</span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(ht.find(</span><span style="color:#9ECBFF">"Ay Lmao"</span><span style="color:#E1E4E8">)) </span><span style="color:#6A737D"># Raises an Error</span></span>
<span class="line"></span></code></pre>
<p>Which gives us:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"></span>
<span class="line"><span style="color:#79B8FF">10</span></span>
<span class="line"><span style="color:#79B8FF">11</span></span>
<span class="line"><span style="color:#79B8FF">13</span></span>
<span class="line"><span style="color:#E1E4E8">[[], [], [], [], [], [], [], [Node(</span><span style="color:#FFAB70">key</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'novelty'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">value</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">), Node(</span><span style="color:#FFAB70">key</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'yeotlvn'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">value</span><span style="color:#F97583">=</span><span style="color:#79B8FF">11</span><span style="color:#E1E4E8">), Node(</span><span style="color:#FFAB70">key</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'voetlny'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">value</span><span style="color:#F97583">=</span><span style="color:#79B8FF">12</span><span style="color:#E1E4E8">), Node(</span><span style="color:#FFAB70">key</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'eoltvyn'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">value</span><span style="color:#F97583">=</span><span style="color:#79B8FF">13</span><span style="color:#E1E4E8">), Node(</span><span style="color:#FFAB70">key</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'asdfgsdfg'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">value</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">)], [], [], [], [], [], [], [], []]</span></span>
<span class="line"><span style="color:#E1E4E8">Traceback (most recent call last):</span></span>
<span class="line"><span style="color:#E1E4E8">  File </span><span style="color:#9ECBFF">"C:\Users\WOODKM\Desktop\development\hashing\hashing-main\hashtables.py"</span><span style="color:#E1E4E8">, line </span><span style="color:#79B8FF">194</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">in</span><span style="color:#F97583"> &#x3C;</span><span style="color:#E1E4E8">module</span><span style="color:#F97583">></span></span>
<span class="line"><span style="color:#79B8FF">    print</span><span style="color:#E1E4E8">(ht.find(</span><span style="color:#9ECBFF">"Ay Lmao"</span><span style="color:#E1E4E8">)) </span><span style="color:#6A737D"># Raises an Error</span></span>
<span class="line"><span style="color:#F97583">          ^^^^^^^^^^^^^^^^^^</span></span>
<span class="line"><span style="color:#E1E4E8">  File </span><span style="color:#9ECBFF">"C:\Users\WOODKM\Desktop\development\hashing\hashing-main\hashtables.py"</span><span style="color:#E1E4E8">, line </span><span style="color:#79B8FF">85</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> find</span></span>
<span class="line"><span style="color:#F97583">    raise</span><span style="color:#79B8FF"> ValueError</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"No value found for key </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">key</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#79B8FF">ValueError</span><span style="color:#E1E4E8">: No value found </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> key Ay Lmao</span></span></code></pre>
<p>An improved version can be found <a href="https://github.com/Descent098/hashing/blob/9a24df728c04d2499ade863b863745e00a43f09f/hashtables.py#L87-L170">here</a>. The main changes are using some of python‚Äôs <a href="">magic methods</a> to make the HashTable more useable, so we just need to rename our methods:</p>
<ul>
<li><code>insert()</code> ‚Äî> <code>__setitem__()</code></li>
<li><code>find()</code> ‚Äî> <code>__getitem__()</code></li>
<li>Add a <code>__repr__()</code> and <code>__str__()</code> method which makes a nicer display when you print the instance</li>
</ul>
<p>If we call this new class <code>HashTableImproved</code> we can now use this class using:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#6A737D"># Test improved hash Table</span></span>
<span class="line"><span style="color:#E1E4E8">ht2 </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> HashTableImproved()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">## Uses __setitem__()</span></span>
<span class="line"><span style="color:#E1E4E8">ht2[</span><span style="color:#9ECBFF">"novelty"</span><span style="color:#E1E4E8">]</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span></span>
<span class="line"><span style="color:#E1E4E8">ht2[</span><span style="color:#9ECBFF">"yeotlvn"</span><span style="color:#E1E4E8">]</span><span style="color:#F97583">=</span><span style="color:#79B8FF">11</span></span>
<span class="line"><span style="color:#E1E4E8">ht2[</span><span style="color:#9ECBFF">"voetlny"</span><span style="color:#E1E4E8">]</span><span style="color:#F97583">=</span><span style="color:#79B8FF">12</span></span>
<span class="line"><span style="color:#E1E4E8">ht2[</span><span style="color:#9ECBFF">"eoltvyn"</span><span style="color:#E1E4E8">]</span><span style="color:#F97583">=</span><span style="color:#79B8FF">13</span></span>
<span class="line"><span style="color:#E1E4E8">ht2[</span><span style="color:#9ECBFF">"asdfgsdfg"</span><span style="color:#E1E4E8">]</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">## Uses __repr__() and __str__()</span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(ht2) </span><span style="color:#6A737D"># HashTableImproved: {'novelty':10,'yeotlvn':11,'voetlny':12,'eoltvyn':13,'asdfgsdfg':10}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">## Uses __getitem__()</span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(ht2[</span><span style="color:#9ECBFF">"novelty"</span><span style="color:#E1E4E8">])</span><span style="color:#6A737D"># 10</span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(ht2[</span><span style="color:#9ECBFF">"yeotlvn"</span><span style="color:#E1E4E8">])</span><span style="color:#6A737D"># 11</span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(ht2[</span><span style="color:#9ECBFF">"eoltvyn"</span><span style="color:#E1E4E8">])</span><span style="color:#6A737D"># 13</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(ht2[</span><span style="color:#9ECBFF">"Ay Lmao"</span><span style="color:#E1E4E8">]) </span><span style="color:#6A737D"># Raises an error</span></span></code></pre>
<h2 id="sub-resource-integrity">Sub-Resource Integrity</h2>
<p>When you‚Äôre downloading a file from the internet you are fundamentally getting it from a network. How do you know that someone has not replaced the original file in transit to your device? How do you know the image your downloading isn‚Äôt actually some malicious code? One way to check is with integrity hashes. For more details you can see <a href="/definitions/hashing#integrity-hashes">this section of our definition of hashing</a>.</p>
<p>For our implementation our basic approach is to:</p>
<ol>
<li>Take input HTML as a string</li>
<li>Parse information about all the script tags in the text, and put them into a list of HashTable‚Äôs</li>
<li>Loop through each of the tags and verify that if there is an integrity hash the provided file or inner content of the tag hashes to the same value</li>
</ol>
<p>To Achieve this there are 4 functions:</p>
<ul>
<li><code>check_input_integrities()</code>: This function takes in the input text and raises a <code>ValueError</code> if any of the tags do not have matching integrities</li>
<li><code>get_script_tag_information()</code>: Takes in the input text, finds all script tags and returns a list of HashTable, where each HashTable is the information about a script tag</li>
<li><code>check_tag_integrity()</code>: Takes in the integrity hash, the function object for the hash function, and either the inline JS, or location of the file to check the integrity hash against</li>
<li><code>generate_script_with_integrity()</code>: Can take in input text or a script file location and give you back a valid script tag with the correct integrity information</li>
</ul>
<p>So to start off with we pass our input HTML to <code>check_input_integrities()</code>, which in turn immediately calls <code>get_script_tag_information()</code> to get the details of each tag.</p>
<p>The code for <code>check_input_integrities()</code> is as follows:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> check_input_integrities</span><span style="color:#E1E4E8">(input_text: </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#6A737D">    # Finds and verifies the integrities of all script tags in input HTML</span></span>
<span class="line"><span style="color:#E1E4E8">    tags </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> get_script_tag_information(input_text) </span><span style="color:#6A737D"># Get list of script tags and their information</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#E1E4E8"> tag </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> tags: </span><span style="color:#6A737D"># Check each tag's integrity</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> tag[</span><span style="color:#9ECBFF">"integrity_scheme"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">and</span><span style="color:#E1E4E8"> tag[</span><span style="color:#9ECBFF">"integrity_hash"</span><span style="color:#E1E4E8">]: </span><span style="color:#6A737D"># Has a hash and listed integrity scheme (hash function)</span></span>
<span class="line"><span style="color:#F97583">            if</span><span style="color:#E1E4E8"> tag[</span><span style="color:#9ECBFF">"src"</span><span style="color:#E1E4E8">]: </span><span style="color:#6A737D"># If tag pulls from a js file</span></span>
<span class="line"><span style="color:#E1E4E8">                check_tag_integrity(tag[</span><span style="color:#9ECBFF">"integrity_hash"</span><span style="color:#E1E4E8">], </span><span style="color:#FFAB70">file_location</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">tag[</span><span style="color:#9ECBFF">"src"</span><span style="color:#E1E4E8">])</span></span>
<span class="line"><span style="color:#F97583">            else</span><span style="color:#E1E4E8">: </span><span style="color:#6A737D"># If tag is inline JS</span></span>
<span class="line"><span style="color:#E1E4E8">                check_tag_integrity(tag[</span><span style="color:#9ECBFF">"integrity_hash"</span><span style="color:#E1E4E8">],</span><span style="color:#FFAB70">inline_js</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">tag[</span><span style="color:#9ECBFF">"inner_content"</span><span style="color:#E1E4E8">])</span></span></code></pre>
<p>Before we get into the code of <code>get_script_tag_information()</code> we need to understand a concept called pattern matching. Broadly speaking what this means is that we have some system that we can define a pattern in some text, when that pattern is matched, we return the info. In our case we are using regex (regular expressions, or rational expressions) to do pattern matching for finding the info about our script tags. This is definitely a shortcut (<a href="https://blog.codinghorror.com/parsing-html-the-cthulhu-way/">this guy wouldn‚Äôt be happy about</a>), but it works well for what we need.</p>
<p>So with regex we first define a pattern, a pattern is the string that tells regex what rules we want for finding text. Our pattern is:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#E1E4E8">pattern </span><span style="color:#F97583">=</span><span style="color:#F97583"> r</span><span style="color:#9ECBFF">"</span><span style="color:#DBEDFF">&#x3C;script </span><span style="color:#79B8FF">(.</span><span style="color:#F97583">*</span><span style="color:#79B8FF">)</span><span style="color:#DBEDFF">></span><span style="color:#79B8FF">(.</span><span style="color:#F97583">*</span><span style="color:#79B8FF">)</span><span style="color:#DBEDFF">&#x3C;/script></span><span style="color:#9ECBFF">"</span></span></code></pre>
<p>The r in front just means raw text. Regex uses characters that python sometimes interprets as different meanings, the r just means ‚Äúno this is all <strong>just plain text</strong>, don‚Äôt do anything fancy with it. If we look at the pattern, it almost looks like regular HTML, just with weird <code>(.*)</code> in it. The <code>(.*)</code> means match any number of characters until the thing that comes after, and put them into a group. If we looked at html like:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="html"><code><span class="line"><span style="color:#E1E4E8">&#x3C;</span><span style="color:#85E89D">script</span><span style="color:#B392F0"> integrity</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"hash_function-10863092770407275780296754544299212800001234567891111111111222222222233333333334444444444555555555566666666667777777777888888888"</span><span style="color:#B392F0"> src</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"file.js"</span><span style="color:#E1E4E8">>&#x3C;/</span><span style="color:#85E89D">script</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;</span><span style="color:#85E89D">script</span><span style="color:#B392F0"> integrity</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"hash_function-10863092770407275780296754544299212800001234567891111111111222222222233333333334444444444555555555566666666667777777777888888888"</span><span style="color:#E1E4E8">>console.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'Hello World'</span><span style="color:#E1E4E8">)&#x3C;/</span><span style="color:#85E89D">script</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;</span><span style="color:#85E89D">script</span><span style="color:#E1E4E8">>console.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"Hello world"</span><span style="color:#E1E4E8">)&#x3C;/</span><span style="color:#85E89D">script</span><span style="color:#E1E4E8">></span></span></code></pre>
<p>We see 2 distinct cases. In the first we have a script tag with attributes, no inner content, and a src file, in the second we see inner content, attributes and no src, and in the third we see no attribtues at all, and just inner content. So we want 2 sets of information:</p>
<ol>
<li>The attributes (which includes a src if it‚Äôs provided)</li>
<li>The inner content</li>
</ol>
<p>So our <code>&#x3C;script (.*)></code> says, look for the text <code>"&#x3C;script "</code> then put everything that comes afterwards <strong>until</strong> the <code>></code> into a group (the parethesis <code>()</code> indicate a group). This group would be our attributes, and then the <code>(.*)&#x3C;/script></code> says all the content after the opening tag and until the end tag will be placed in a second group (our inner content).</p>
<p><img src="/tech/blog/hashing/regex-match.png" alt=""></p>
<p>Regex can do a lot of cool stuff, and you can see a great intro <a href="https://www.youtube.com/watch?v=rhzKDrUiJVk">here</a>, but for us I used <a href="https://regex101.com/">regex101</a> to generate our code and modified it from there. The basics would be:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> re</span></span>
<span class="line"><span style="color:#E1E4E8">regex </span><span style="color:#F97583">=</span><span style="color:#F97583"> r</span><span style="color:#9ECBFF">"</span><span style="color:#DBEDFF">&#x3C;script </span><span style="color:#79B8FF">(.</span><span style="color:#F97583">*</span><span style="color:#79B8FF">)</span><span style="color:#DBEDFF">></span><span style="color:#79B8FF">(.</span><span style="color:#F97583">*</span><span style="color:#79B8FF">)</span><span style="color:#DBEDFF">&#x3C;/script></span><span style="color:#9ECBFF">"</span><span style="color:#6A737D"> # Pattern used to find info</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">text </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> ""</span><span style="color:#6A737D"> # Some text to test with</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">matches </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> re.finditer(regex, text, re.</span><span style="color:#79B8FF">MULTILINE</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">for</span><span style="color:#E1E4E8"> match </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> matches:</span></span>
<span class="line"><span style="color:#E1E4E8">    attributes </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> match.group(</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">).split(</span><span style="color:#9ECBFF">" "</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    inner_content </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> match.group(</span><span style="color:#79B8FF">2</span><span style="color:#E1E4E8">)</span></span></code></pre>
<p>Where each match in the loop is a new <code>&#x3C;script></code> tag, and <code>group(1)</code> is our first match groups (the raw attributes), and group(2) is our inner content. From here we then split the attributes up, and pull out the ones we need, and for each tag we put it‚Äôs info into one of our HashTables:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> get_script_tag_information</span><span style="color:#E1E4E8">(text:</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">) -> List[HashTableImproved]:</span></span>
<span class="line"><span style="color:#6A737D">    # Parses HTML input and returns details about the script tags inside</span></span>
<span class="line"><span style="color:#E1E4E8">    matches </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> re.finditer(regex, text, re.</span><span style="color:#79B8FF">MULTILINE</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    results </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> []</span></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#E1E4E8"> match </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> matches:</span></span>
<span class="line"><span style="color:#E1E4E8">        attributes </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> match.group(</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">).split(</span><span style="color:#9ECBFF">" "</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">        src </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> ""</span></span>
<span class="line"><span style="color:#E1E4E8">        integrity_hash </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> ""</span></span>
<span class="line"><span style="color:#E1E4E8">        integrity_scheme </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> ""</span></span>
<span class="line"><span style="color:#E1E4E8">        inner_content </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> match.group(</span><span style="color:#79B8FF">2</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#9ECBFF"> "src"</span><span style="color:#F97583"> in</span><span style="color:#E1E4E8"> match.group(</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#F97583">            for</span><span style="color:#E1E4E8"> attribute </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> attributes:</span></span>
<span class="line"><span style="color:#F97583">                if</span><span style="color:#9ECBFF"> "src"</span><span style="color:#F97583"> in</span><span style="color:#E1E4E8"> attribute:</span></span>
<span class="line"><span style="color:#E1E4E8">                    src </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> attribute.split(</span><span style="color:#9ECBFF">"="</span><span style="color:#E1E4E8">)[</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">].replace(</span><span style="color:#9ECBFF">"</span><span style="color:#79B8FF">\"</span><span style="color:#9ECBFF">"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">""</span><span style="color:#E1E4E8">).replace(</span><span style="color:#9ECBFF">"'"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">""</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#9ECBFF"> "integrity"</span><span style="color:#F97583"> in</span><span style="color:#E1E4E8"> match.group(</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">): </span><span style="color:#6A737D"># Integrity exists in the tag</span></span>
<span class="line"><span style="color:#F97583">            for</span><span style="color:#E1E4E8"> attribute </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> attributes: </span><span style="color:#6A737D"># Search for the integrity attribute</span></span>
<span class="line"><span style="color:#F97583">                if</span><span style="color:#9ECBFF"> "integrity"</span><span style="color:#F97583"> in</span><span style="color:#E1E4E8"> attribute:</span></span>
<span class="line"><span style="color:#E1E4E8">                    integrity_string </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> attribute.split(</span><span style="color:#9ECBFF">"="</span><span style="color:#E1E4E8">)[</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">].replace(</span><span style="color:#9ECBFF">"</span><span style="color:#79B8FF">\"</span><span style="color:#9ECBFF">"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">""</span><span style="color:#E1E4E8">).replace(</span><span style="color:#9ECBFF">"'"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">""</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">                    integrity_scheme, integrity_hash </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> integrity_string.split(</span><span style="color:#9ECBFF">"-"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">                    break</span></span>
<span class="line"><span style="color:#E1E4E8">        </span></span>
<span class="line"><span style="color:#6A737D">        # Store information about tag to a hash table</span></span>
<span class="line"><span style="color:#E1E4E8">        current_tag_info </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> HashTableImproved()</span></span>
<span class="line"><span style="color:#E1E4E8">        current_tag_info[</span><span style="color:#9ECBFF">"src"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> src</span></span>
<span class="line"><span style="color:#E1E4E8">        current_tag_info[</span><span style="color:#9ECBFF">"integrity_scheme"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> integrity_scheme</span></span>
<span class="line"><span style="color:#E1E4E8">        current_tag_info[</span><span style="color:#9ECBFF">"integrity_hash"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> integrity_hash</span></span>
<span class="line"><span style="color:#E1E4E8">        current_tag_info[</span><span style="color:#9ECBFF">"inner_content"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> inner_content</span></span>
<span class="line"><span style="color:#E1E4E8">        </span></span>
<span class="line"><span style="color:#6A737D">        # Store hash table in results list</span></span>
<span class="line"><span style="color:#E1E4E8">        results.append(current_tag_info)</span></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#E1E4E8"> results</span></span></code></pre>
<p>Now we have our tag info we go back to our <code>check_input_integrities()</code> function and the remaining lines are:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#F97583">for</span><span style="color:#E1E4E8"> tag </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> tags: </span><span style="color:#6A737D"># Check each tag's integrity</span></span>
<span class="line"><span style="color:#F97583">  if</span><span style="color:#E1E4E8"> tag[</span><span style="color:#9ECBFF">"integrity_scheme"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">and</span><span style="color:#E1E4E8"> tag[</span><span style="color:#9ECBFF">"integrity_hash"</span><span style="color:#E1E4E8">]: </span><span style="color:#6A737D"># Has a hash and listed integrity scheme (hash function)</span></span>
<span class="line"><span style="color:#F97583">      if</span><span style="color:#E1E4E8"> tag[</span><span style="color:#9ECBFF">"src"</span><span style="color:#E1E4E8">]: </span><span style="color:#6A737D"># If tag pulls from a js file</span></span>
<span class="line"><span style="color:#E1E4E8">          check_tag_integrity(tag[</span><span style="color:#9ECBFF">"integrity_hash"</span><span style="color:#E1E4E8">], </span><span style="color:#FFAB70">file_location</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">tag[</span><span style="color:#9ECBFF">"src"</span><span style="color:#E1E4E8">])</span></span>
<span class="line"><span style="color:#F97583">      else</span><span style="color:#E1E4E8">: </span><span style="color:#6A737D"># If tag is inline JS</span></span>
<span class="line"><span style="color:#E1E4E8">          check_tag_integrity(tag[</span><span style="color:#9ECBFF">"integrity_hash"</span><span style="color:#E1E4E8">], </span><span style="color:#FFAB70">inline_js</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">tag[</span><span style="color:#9ECBFF">"inner_content"</span><span style="color:#E1E4E8">])</span></span></code></pre>
<p>So let‚Äôs look at <code>check_tag_integrity()</code>:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> check_tag_integrity</span><span style="color:#E1E4E8">(tag_integrity_hash:</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">, tag_integrity_hash_function:</span><span style="color:#79B8FF">callable</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">hash_function, file_location: </span><span style="color:#79B8FF">str</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">""</span><span style="color:#E1E4E8">, inline_js:</span><span style="color:#79B8FF">str</span><span style="color:#F97583"> =</span><span style="color:#9ECBFF">""</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#6A737D">    # A function to check the integrity of an individual script tag</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> file_location:</span></span>
<span class="line"><span style="color:#F97583">        with</span><span style="color:#79B8FF"> open</span><span style="color:#E1E4E8">(file_location, </span><span style="color:#9ECBFF">"r"</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">as</span><span style="color:#E1E4E8"> src_file:</span></span>
<span class="line"><span style="color:#E1E4E8">            file_integrity </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> tag_integrity_hash_function(src_file.read())</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#F97583"> not</span><span style="color:#79B8FF"> str</span><span style="color:#E1E4E8">(file_integrity) </span><span style="color:#F97583">==</span><span style="color:#79B8FF"> str</span><span style="color:#E1E4E8">(tag_integrity_hash):</span></span>
<span class="line"><span style="color:#F97583">            raise</span><span style="color:#79B8FF"> ValueError</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"File </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">file_location</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF"> content does not match the integrity hash provided"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">    else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">        js_integrity </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> tag_integrity_hash_function(inline_js)</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#F97583"> not</span><span style="color:#79B8FF"> str</span><span style="color:#E1E4E8">(js_integrity) </span><span style="color:#F97583">==</span><span style="color:#79B8FF"> str</span><span style="color:#E1E4E8">(tag_integrity_hash):</span></span>
<span class="line"><span style="color:#F97583">            raise</span><span style="color:#79B8FF"> ValueError</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"Provided inline JS does not match integrity hash:</span><span style="color:#79B8FF">\n{</span><span style="color:#E1E4E8">inline_js</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span><span style="color:#E1E4E8">)</span></span></code></pre>
<p>Everything here is relatively straightforward, except maybe the <code>tag_integrity_hash_function</code> parameter. In python you can pass functions as objects, this is handy because you can have a function run other functions whenever you want. Since we only allowed 1 scheme in our integrity hash checker, we don‚Äôt need to override this. But let‚Äôs say a tag used the python default <code>hash()</code> function, we could replace the parameter with this function, and it would be used to check, instead of <code>hash_function()</code></p>
<h2 id="conclusion">Conclusion</h2>
<p>So in less than 300 lines of code we managed to implement a hash funciton, a hash table, integrity hash checking, and a password system. Hopefully this helped make hashing seem a bit less magical, and gave you some interesting use cases to dive deeper on!</p>  </article> </main> <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js" integrity="sha256-mm3Re3y7xlvh+yCD+l/Zs1d+PU0AEad93MkWvljfm/s=" crossorigin="anonymous"></script> <script type="module">mermaid.initialize({securityLevel:"loose",theme:"dark"});</script>  </main> </div> <footer class="footer footer-center block mb-5 pt-10"> <div class="pb-2">
&copy; 2026 Kieran Wood
</div> <div class="inline opacity-75"> <!-- Thanks for using this template. You can keep this line to support my work :) --> <a href="https://astrofy-template.netlify.app/" target="_blank" class="font-bold">Astrofy Template</a> developed by
<a href="https://manuelernestog.github.io" target="_blank" class="font-bold">Manuel Ernesto ‚ö°Ô∏è</a> </div> </footer>  </div> <div class="drawer-side z-40"> <label for="my-drawer" class="drawer-overlay"></label> <aside class="px-2 pt-2 h-auto min-h-full w-[19rem] bg-base-200 text-base-content flex flex-col"> <div class="w-fit mx-auto mt-5 mb-6"> <a href="/"> <div class="avatar transition ease-in-out hover:scale-[102%] block m-auto"> <div class="w-[8.5rem]"> <img src="/tech/profile.jpg" alt="Profile image" loading="lazy" decoding="async" fetchpriority="auto" width="300" height="300" class="mask mask-circle"> </div> </div> </a> </div> <ul class="menu grow shrink menu-md overflow-y-auto"> <li><a class="py-3 text-base" id="home" href="/tech/">Home</a></li> <li><a class="py-3 text-base" id="projects" href="/tech/projects">Projects</a></li> <!-- <li><a class="py-3 text-base" id="services" href="/tech/services">Services</a></li>
    <li><a class="py-3 text-base" id="store" href="/tech/store">Store</a></li> --> <li><a class="py-3 text-base" id="blog" href="/tech/blog/">Blog</a></li> <li><a class="py-3 text-base" id="cv" href="/tech/cv">CV</a></li> <li><a class="py-3 text-base" href="/tech/contact">Contact</a></li> </ul> <script>(function(){const sideBarActiveItemID = undefined;
const activeClass = "bg-base-300";

const activeItemElem = document.getElementById(sideBarActiveItemID);
activeItemElem && activeItemElem.classList.add(activeClass);
})();</script> <div class="block sticky pointer-events-none bottom-10 bg-base-200 justify-center h-12 [mask-image:linear-gradient(transparent,#000000)]"></div> <div class="social-icons px-4 pb-5 pt-1 flex self-center justify-center sticky bottom-0 bg-base-200"> <a href="https://github.com/descent098" target="_blank" class="mx-3" aria-label="Github" title="Github"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" style="fill: currentColor;transform: ;msFilter:;"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.026 2c-5.509 0-9.974 4.465-9.974 9.974 0 4.406 2.857 8.145 6.821 9.465.499.09.679-.217.679-.481 0-.237-.008-.865-.011-1.696-2.775.602-3.361-1.338-3.361-1.338-.452-1.152-1.107-1.459-1.107-1.459-.905-.619.069-.605.069-.605 1.002.07 1.527 1.028 1.527 1.028.89 1.524 2.336 1.084 2.902.829.091-.645.351-1.085.635-1.334-2.214-.251-4.542-1.107-4.542-4.93 0-1.087.389-1.979 1.024-2.675-.101-.253-.446-1.268.099-2.64 0 0 .837-.269 2.742 1.021a9.582 9.582 0 0 1 2.496-.336 9.554 9.554 0 0 1 2.496.336c1.906-1.291 2.742-1.021 2.742-1.021.545 1.372.203 2.387.099 2.64.64.696 1.024 1.587 1.024 2.675 0 3.833-2.33 4.675-4.552 4.922.355.308.675.916.675 1.846 0 1.334-.012 2.41-.012 2.737 0 .267.178.577.687.479C19.146 20.115 22 16.379 22 11.974 22 6.465 17.535 2 12.026 2z"></path> </svg> </a> <a href="https://www.linkedin.com/in/kieran-wood" target="_blank" class="mx-3" aria-label="Linkedin" title="Linkedin"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" style="fill: currentColor;transform: ;msFilter:;"><circle cx="4.983" cy="5.009" r="2.188"></circle><path d="M9.237 8.855v12.139h3.769v-6.003c0-1.584.298-3.118 2.262-3.118 1.937 0 1.961 1.811 1.961 3.218v5.904H21v-6.657c0-3.27-.704-5.783-4.526-5.783-1.835 0-3.065 1.007-3.568 1.96h-.051v-1.66H9.237zm-6.142 0H6.87v12.139H3.095z"></path> </svg> </a> <a href="https://instagram.com/descent098" target="_blank" class="mx-3" aria-label="Instagram" title="Instagram"> <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 -5 24 24" style="fill: currentColor;transform: ;msFilter:;"><path d="M8 0C5.829 0 5.556.01 4.703.048 3.85.088 3.269.222 2.76.42a3.917 3.917 0 0 0-1.417.923A3.927 3.927 0 0 0 .42 2.76C.222 3.268.087 3.85.048 4.7.01 5.555 0 5.827 0 8.001c0 2.172.01 2.444.048 3.297.04.852.174 1.433.372 1.942.205.526.478.972.923 1.417.444.445.89.719 1.416.923.51.198 1.09.333 1.942.372C5.555 15.99 5.827 16 8 16s2.444-.01 3.298-.048c.851-.04 1.434-.174 1.943-.372a3.916 3.916 0 0 0 1.416-.923c.445-.445.718-.891.923-1.417.197-.509.332-1.09.372-1.942C15.99 10.445 16 10.173 16 8s-.01-2.445-.048-3.299c-.04-.851-.175-1.433-.372-1.941a3.926 3.926 0 0 0-.923-1.417A3.911 3.911 0 0 0 13.24.42c-.51-.198-1.092-.333-1.943-.372C10.443.01 10.172 0 7.998 0h.003zm-.717 1.442h.718c2.136 0 2.389.007 3.232.046.78.035 1.204.166 1.486.275.373.145.64.319.92.599.28.28.453.546.598.92.11.281.24.705.275 1.485.039.843.047 1.096.047 3.231s-.008 2.389-.047 3.232c-.035.78-.166 1.203-.275 1.485a2.47 2.47 0 0 1-.599.919c-.28.28-.546.453-.92.598-.28.11-.704.24-1.485.276-.843.038-1.096.047-3.232.047s-2.39-.009-3.233-.047c-.78-.036-1.203-.166-1.485-.276a2.478 2.478 0 0 1-.92-.598 2.48 2.48 0 0 1-.6-.92c-.109-.281-.24-.705-.275-1.485-.038-.843-.046-1.096-.046-3.233 0-2.136.008-2.388.046-3.231.036-.78.166-1.204.276-1.486.145-.373.319-.64.599-.92.28-.28.546-.453.92-.598.282-.11.705-.24 1.485-.276.738-.034 1.024-.044 2.515-.045v.002zm4.988 1.328a.96.96 0 1 0 0 1.92.96.96 0 0 0 0-1.92zm-4.27 1.122a4.109 4.109 0 1 0 0 8.217 4.109 4.109 0 0 0 0-8.217zm0 1.441a2.667 2.667 0 1 1 0 5.334 2.667 2.667 0 0 1 0-5.334"></path> </svg> </a> <a href="/tech/rss.xml" target="_blank" class="mx-3" aria-label="RSS Feed" title="RSS Feed"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" style="fill: currentColor;transform: ;msFilter:;"><path d="M19 20.001C19 11.729 12.271 5 4 5v2c7.168 0 13 5.832 13 13.001h2z"></path><path d="M12 20.001h2C14 14.486 9.514 10 4 10v2c4.411 0 8 3.589 8 8.001z"></path><circle cx="6" cy="18" r="2"></circle> </svg> </a> </div> </aside> </div> </div> </body></html>