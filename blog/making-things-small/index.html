<!DOCTYPE html><html lang="en" data-theme="lofi"> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/jpeg" href="/tech/profile.jpg"><meta name="generator" content="Astro v4.4.15"><!-- Primary Meta Tags --><title>Making Things Small | Kieran Wood</title><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><meta name="title" content="Making Things Small"><meta name="description" content="How compression works with simple examples"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://kieranwood.ca/tech/blog/making-things-small/"><meta property="og:title" content="Making Things Small"><meta property="og:description" content="How compression works with simple examples"><meta property="og:image" content="https://kieranwood.ca/tech/blog/compression/hero.jpeg"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://kieranwood.ca/tech/blog/making-things-small/"><meta property="twitter:title" content="Making Things Small"><meta property="twitter:description" content="How compression works with simple examples"><meta property="twitter:image" content="https://kieranwood.ca/tech/blog/compression/hero.jpeg"><link rel="stylesheet" href="/tech/_astro/_page_.D_l8DYJv.css" />
<style>.time-line-container>div:last-child .education__time>.education__line{display:none}details{background:#f0f0f0;padding:1rem;border-radius:.7rem;margin:.5rem auto;width:100%}summary{cursor:pointer}#TOC-list{list-style:none}#TOC-list li{margin-top:.15rem}.danger-banner{display:flex;flex-direction:row;background:#f44336;border-radius:.25rem;padding:1.1rem;color:#fff!important;flex-wrap:wrap}.danger-banner strong,.danger-banner a{color:#fff!important}.danger-banner:before{content:"!üõë Danger üõë!";flex-basis:100%;margin-bottom:.5rem;padding:.6rem;border-radius:.25rem;text-align:center;background:red;text-transform:uppercase}.warning-banner{display:flex;flex-direction:row;background:#fcc51e;border-radius:.25rem;padding:1.1rem;color:#141414!important;flex-wrap:wrap}.warning-banner strong,.warning-banner a{color:#141414!important}.warning-banner:before{content:"üü° Warning üü°";flex-basis:100%;margin-bottom:.5rem;padding:.6rem;border-radius:.25rem;text-align:center;background:#f6cb49;text-transform:uppercase;text-shadow:1px 1px 1px rgb(93,93,93)}.astro-route-announcer{position:absolute;left:0;top:0;clip:rect(0 0 0 0);-webkit-clip-path:inset(50%);clip-path:inset(50%);overflow:hidden;white-space:nowrap;width:1px;height:1px}
@keyframes astroFadeInOut{0%{opacity:1}to{opacity:0}}@keyframes astroFadeIn{0%{opacity:0}}@keyframes astroFadeOut{to{opacity:0}}@keyframes astroSlideFromRight{0%{transform:translate(100%)}}@keyframes astroSlideFromLeft{0%{transform:translate(-100%)}}@keyframes astroSlideToRight{to{transform:translate(100%)}}@keyframes astroSlideToLeft{to{transform:translate(-100%)}}@media (prefers-reduced-motion){::view-transition-group(*),::view-transition-old(*),::view-transition-new(*){animation:none!important}[data-astro-transition-scope]{animation:none!important}}
</style><script type="module" src="/tech/_astro/hoisted.CHePpst8.js"></script><style>[data-astro-transition-scope="astro-vz7ejtmd-1"] { view-transition-name: __2ftech_2fblog_2fcompression_2fhero_2ejpeg; }</style><style>[data-astro-transition-scope="astro-frvnq75b-2"] { view-transition-name: Making_20Things_20Small; }</style></head> <body> <div class="bg-base-100 drawer lg:drawer-open"> <input id="my-drawer" type="checkbox" class="drawer-toggle"> <div class="drawer-content bg-base-100"> <div class="sticky lg:hidden top-0 z-30 flex h-16 w-full justify-center bg-opacity-90 backdrop-blur transition-all duration-100 bg-base-100 text-base-content shadow-sm"> <div class="navbar"> <div class="navbar-start"> <label for="my-drawer" class="btn btn-square btn-ghost"> <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block w-5 h-5 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path> </svg> </label> </div> <div class="navbar-center"> <a class="btn btn-ghost normal-case text-xl" href="/">Kieran Wood ‚ö°Ô∏è</a> </div> <div class="navbar-end"></div> </div> </div> <div class="md:flex md:justify-center"> <main class="p-6 pt-10 lg:max-w-[900px] max-w-[100vw]">  <main class="md:flex md:justify-center"> <article class="prose prose-lg max-w-[750px] prose-img:mx-auto"> <img src="/tech/blog/compression/hero.jpeg" alt="Making Things Small" class="w-full mb-6" style="border-radius:.5em" data-astro-transition-scope="astro-vz7ejtmd-1" width="750" height="422" loading="lazy" decoding="async"> <h1 class="title my-2 text-4xl font-bold" data-astro-transition-scope="astro-frvnq75b-2">Making Things Small</h1> <time>Jul 3, 2023</time> <br>  <a href="/blog/tag/optimization" class="badge badge-outline ml-2 no-underline"> optimization </a><a href="/blog/tag/theory" class="badge badge-outline ml-2 no-underline"> theory </a><a href="/blog/tag/terminology" class="badge badge-outline ml-2 no-underline"> terminology </a>  <p class="text-lg text-italics">Crossposted from <a class="text-violet-700" target="_blank" href="https://schulichignite.com/blog/making-things-small/">https://schulichignite.com/blog/making-things-small/</a></p> <div class="divider my-2"></div> <div> <h2>Table of contents</h2> <ul id="TOC-list"> <li> <a href="#list-and-dictionary-comprehensions" class="no-underline"> List and dictionary comprehensions </a> </li><li> <a href="#lossless-vs-lossy" class="no-underline"> Lossless vs Lossy </a> </li><li> <a href="#lossless" class="no-underline"> Lossless </a> </li><li> <a href="#lossy" class="no-underline"> Lossy </a> </li><li> <a href="#simple-text-example" class="no-underline"> Simple text example </a> </li><li> <a href="#where-it-gets-complicated" class="no-underline"> Where it gets complicated </a> </li><li> <a href="#some-improvements" class="no-underline"> Some improvements </a> </li><li> <a href="#an-even-better-option" class="no-underline"> An even Better option </a> </li><li> <a href="#the-algorithm" class="no-underline"> The Algorithm </a> </li><li> <a href="#images" class="no-underline"> Images </a> </li><li> <a href="#the-algorithm-1" class="no-underline"> The algorithm </a> </li><li> <a href="#file-types" class="no-underline"> File types </a> </li><li> <a href="#video" class="no-underline"> Video </a> </li><li> <a href="#real-world-compression-systems" class="no-underline"> Real world compression systems </a> </li> </ul> </div>
  <hr><p>Compression is the art of taking some data and making it smaller. If you want more details about common compression schemes take a look at our <a href="/definitions/compression">definition page for compression</a>. This article is instead going to focus on showing you compression with code examples, and simple custom compression schemes in python!</p>
<p>The repository for the full code examples can be found <a href="https://github.com/Descent098/compression">here</a></p>
<h2 id="list-and-dictionary-comprehensions">List and dictionary comprehensions</h2>
<p>On top of the basic python syntax the code examples use a few concepts you should know.</p>
<p>A list comprehension syntactically shorter way to produce a list of values with a simple calculation. It is intended to replace the design pattern of:</p>
<ol>
<li>instantiating an empty list</li>
<li>Iterate and store values in the list</li>
<li>return or use list values.</li>
</ol>
<p>For example:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#E1E4E8">result </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [] </span><span style="color:#6A737D"># 1. Initialize empty list</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># 2. Iterate and store values in the list</span></span>
<span class="line"><span style="color:#F97583">for</span><span style="color:#E1E4E8"> number </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">): </span><span style="color:#6A737D"># Square numbers from 0-9 and add them to the result list</span></span>
<span class="line"><span style="color:#E1E4E8">    result.append(number</span><span style="color:#F97583">**</span><span style="color:#79B8FF">2</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(result) </span><span style="color:#6A737D"># 3. Return or use list values</span></span></code></pre>
<p>Can be shortened to:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#E1E4E8">result </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [number </span><span style="color:#F97583">**</span><span style="color:#79B8FF"> 2</span><span style="color:#F97583"> for</span><span style="color:#E1E4E8"> number </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">)] </span><span style="color:#6A737D"># Steps 1-2</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(result) </span><span style="color:#6A737D"># 3. Return or use list values</span></span></code></pre>
<p>which produces:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#E1E4E8">[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">4</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">9</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">16</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">25</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">36</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">49</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">64</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">81</span><span style="color:#E1E4E8">]</span></span></code></pre>
<p>It does exactly the same as the above example, it is just shorter. The basic syntax is <code>[operation for variable in iterable]</code> Were operation is the calculation (or function) being run, variable is the name for the temporary iteration variable made, and iterable is some form of iterable (list, generator, set etc.). We can also do this conditionally, so for example if we wanted to only include even numbers we could do:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#E1E4E8">evens </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [number </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> number </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">if</span><span style="color:#E1E4E8"> number </span><span style="color:#F97583">%</span><span style="color:#79B8FF">2</span><span style="color:#F97583"> ==</span><span style="color:#79B8FF"> 0</span><span style="color:#E1E4E8">]</span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(evens) </span><span style="color:#6A737D"># [0, 2, 4, 6, 8]</span></span></code></pre>
<p>And we can do an if-else statement using:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#E1E4E8">evens </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#9ECBFF">"even"</span><span style="color:#F97583"> if</span><span style="color:#E1E4E8"> number </span><span style="color:#F97583">%</span><span style="color:#79B8FF">2</span><span style="color:#F97583"> ==</span><span style="color:#79B8FF"> 0</span><span style="color:#F97583"> else</span><span style="color:#9ECBFF"> "odd"</span><span style="color:#F97583"> for</span><span style="color:#E1E4E8"> number </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">)]</span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(evens) </span><span style="color:#6A737D"># ['even', 'odd', 'even', 'odd', 'even', 'odd', 'even', 'odd', 'even', 'odd']</span></span></code></pre>
<p>We can do the same thing with dictionaries. For example:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#E1E4E8">names </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#9ECBFF">"Kieran"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"Frank"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"Amy"</span><span style="color:#E1E4E8">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">users </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> dict</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#F97583">for</span><span style="color:#E1E4E8"> name </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> names:</span></span>
<span class="line"><span style="color:#E1E4E8">    users[name] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> {</span><span style="color:#9ECBFF">"new_user"</span><span style="color:#E1E4E8">:</span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(users) </span><span style="color:#6A737D"># {'Kieran': {'new_user': True}, 'Frank': {'new_user': True}, 'Amy': {'new_user': True}}</span></span></code></pre>
<p>Can be shortened to:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#E1E4E8">names </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#9ECBFF">"Kieran"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"Frank"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"Amy"</span><span style="color:#E1E4E8">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">users </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> {name:{</span><span style="color:#9ECBFF">"new_user"</span><span style="color:#E1E4E8">:</span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">} </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> name </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> names}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(users) </span><span style="color:#6A737D"># {'Kieran': {'new_user': True}, 'Frank': {'new_user': True}, 'Amy': {'new_user': True}}</span></span></code></pre>
<h2 id="lossless-vs-lossy">Lossless vs Lossy</h2>
<p>The other concept you should be aware of is that there are two different common ways of doing compression depending on what you need it for. Lossless and lossy. The text algorithm we will cover is lossless, the image one is lossy.</p>
<h3 id="lossless">Lossless</h3>
<p>Lossless formats are what we‚Äôre used to. They take in some data, compress it, and at the end you can decompress it to get back exactly the data you put in. This is handy for things like text (you usually don‚Äôt want just <strong>some</strong> of a text file), or images that need high fidelity. PNG is a format that is a lossless form of compression.</p>
<h3 id="lossy">Lossy</h3>
<p>Lossy is unlike the systems we‚Äôve seen before. With typical compression we want to get back <strong>exactly</strong> what we had before we compressed it. With lossy compression we want to be ‚Äúclose‚Äù. Imagine you have a large image on a small screen, let‚Äôs say a 1920x1080px image on a 480x720px screen. If we were to resize the image and in the process remove 1/8 of the pixels and just stich together a smaller but ‚Äúclose enough‚Äù version of the image, most people wouldn‚Äôt notice.</p>
<p>Formats like JPG are lossy. They basically create versions of images that are ‚Äúclose enough‚Äù to the original source images. This can cause some issues like <a href="https://en.wikipedia.org/wiki/Compression_artifact">artifacts</a>, a good quick explainer about this can be found <a href="https://www.youtube.com/watch?v=yBX8GFqt6GA">here as a video</a>. Lossy schemes are good for large data like images and videos. Especially when sending the data over a network!</p>
<h2 id="simple-text-example">Simple text example</h2>
<p>The most common thing we will want to compress is text. We‚Äôre going to come up with a super simple algorithm to do this.</p>
<p>There are a few assumptions we‚Äôre making for this to work somewhat well:</p>
<ol>
<li>Text is in english</li>
<li>The text does not have any numbers</li>
<li>The text is general (if it‚Äôs a programming language you want to pick different common words)</li>
<li>The text is at least a few paragraphs (if it‚Äôs super short compression is unlikely to be helpful)</li>
</ol>
<p>With this the main idea is that we can use the indicies of a list to replace words. So if we have the list <code>words = ["orange", "apple", "mango"]</code> then we can take text like <code>text = "I love oranges, they are about on par with apples, but they are much better than mangos"</code> and replace each occurance of the word with it‚Äôs index in the list. So the text would become <code>text = "I love 0s, they are about on par with 1s, but they are much better than 3s"</code>, <strong>each letter and number is a byte</strong> (8 bits), so we saved 13 bytes of space in this example.</p>
<p><img src="/tech/blog/compression/io-example.png" alt=""></p>
<p>The problem is that most people don‚Äôt just talk about fruit, so we need to create a list of words that is useful to us. To keep it simple we can just take the 100 most common words in english and hope most text will have them. So the algorithm we‚Äôre going to use is this:</p>
<ol>
<li>Create a list of the most common english words sorted by length (longest first), include the lowercase and capitalized versions</li>
<li>Loop over the list of words and replace each occurance of a word in the input text with it‚Äôs index in the common words list</li>
</ol>
<p>So the function would look like this:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> compress_by_common_words</span><span style="color:#E1E4E8">(input_text: </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">) -> </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#9ECBFF">    """Takes in some input text and returns the compressed form"""</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#6A737D">    # 1. Create a list of the most common english words</span></span>
<span class="line"><span style="color:#E1E4E8">    common_words </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span></span>
<span class="line"><span style="color:#9ECBFF">    "compression"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"efficient"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"encoding"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"data"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">    "the"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"at"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"there"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"some"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"my"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"of"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"be"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"use"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"her"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"than"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">    "and"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"this"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"an"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"would"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"first"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"a"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"have"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"each"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"make"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"water"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">    "to"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"from"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"which"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"like"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"been"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"in"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"or"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"she"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"him"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"call"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">    "is"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"one"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"do"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"into"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"who"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"you"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"had"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"how"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"time"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"oil"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">    "that"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"by"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"their"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"has"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"its"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"it"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"word"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"if"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"look"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"now"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">    "he"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"but"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"will"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"two"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"find"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"was"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"not"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"up"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"more"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"long"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">    "for"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"what"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"other"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"write"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"down"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"on"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"all"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"about"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"go"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"day"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">    "are"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"were"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"out"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"see"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"did"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"as"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"we"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"many"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"number"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"get"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">    "with"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"when"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"then"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"no"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"come"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"his"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"your"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"them"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"way"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"made"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">    "they"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"can"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"these"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"could"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"may"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"I"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"said"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"so"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"people"</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">"part"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">    ]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    ## 1.2 Add capitalized version of the words</span></span>
<span class="line"><span style="color:#E1E4E8">    common_words </span><span style="color:#F97583">+=</span><span style="color:#E1E4E8"> [word.capitalize() </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> word </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> common_words]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    ## 1.3 Sort by length; Longest word first</span></span>
<span class="line"><span style="color:#E1E4E8">    common_words </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> sorted</span><span style="color:#E1E4E8">(common_words, </span><span style="color:#FFAB70">key</span><span style="color:#F97583">=</span><span style="color:#79B8FF">len</span><span style="color:#E1E4E8">)[::</span><span style="color:#F97583">-</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    # 2. Loop over the list of words</span></span>
<span class="line"><span style="color:#E1E4E8">    result </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> input_text</span></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#E1E4E8"> word </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> common_words:</span></span>
<span class="line"><span style="color:#6A737D">        ## 2.1 Replace each occurance of a word in the input text with</span></span>
<span class="line"><span style="color:#6A737D">        ## it's index in the common words list</span></span>
<span class="line"><span style="color:#E1E4E8">        result </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> result.replace(word, </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">(common_words.index(word)))</span></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#E1E4E8"> result</span></span></code></pre>
<p>Now we have our code it‚Äôs time to get some text, naturally I figured asking chat GPT to write a few paragraphs on compression would be a good example, so here‚Äôs the code for testing our system:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#E1E4E8">input_text </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> """"</span></span>
<span class="line"><span style="color:#9ECBFF">Compression is a fundamental technique used in various fields to reduce the size of data while preserving its essential information. In computer science and information technology, data compression plays a crucial role in storage, transmission, and processing of large amounts of information. By eliminating redundancy and exploiting patterns in data, compression algorithms can significantly reduce file sizes, resulting in more efficient use of storage space and faster data transfer over networks. From simple algorithms like run-length encoding to sophisticated methods like Huffman coding and Lempel-Ziv-Welch (LZW) algorithm, compression enables us to store and transmit data more effectively.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9ECBFF">Compression algorithms employ different strategies to achieve efficient data compression. Lossless compression techniques ensure that the compressed data can be fully reconstructed back to its original form without any loss of information. These techniques are commonly used in applications where preserving the integrity of data is critical, such as archiving files, databases, and text documents. On the other hand, lossy compression methods trade off some degree of data fidelity for higher compression ratios. Such techniques are commonly used in multimedia applications like image, audio, and video compression, where the removal of non-essential information or imperceptible details can lead to significant reduction in file sizes while maintaining acceptable perceptual quality.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9ECBFF">The benefits of compression extend beyond just saving storage space and reducing transmission time. Compressed data also reduces the demand for computational resources and improves system performance. When processing large datasets, compressed files can be read and decompressed faster than their uncompressed counterparts, allowing for quicker access and analysis. Moreover, compression enables efficient streaming of multimedia content, making it possible to deliver high-quality videos and audio over bandwidth-constrained networks. By minimizing the amount of data that needs to be transmitted, compression contributes to a smoother and more efficient digital experience, whether it's browsing the web, downloading files, or streaming media.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9ECBFF">In summary, compression is a vital technique that enables efficient storage, transmission, and processing of data. It utilizes various algorithms and strategies to reduce file sizes while preserving data integrity or achieving perceptual quality. By minimizing storage requirements, improving data transfer speeds, and enhancing system performance, compression plays a central role in modern computing and communication systems, benefiting users across a wide range of applications.</span></span>
<span class="line"><span style="color:#9ECBFF">"""</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Print info </span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"Original Length of text = </span><span style="color:#79B8FF">{len</span><span style="color:#E1E4E8">(input_text)</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">result </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> compress_by_common_words(input_text)</span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"Length of compressed text = </span><span style="color:#79B8FF">{len</span><span style="color:#E1E4E8">(result)</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span><span style="color:#E1E4E8">)</span></span></code></pre>
<h3 id="where-it-gets-complicated">Where it gets complicated</h3>
<p>With this we get the output:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span>Original Length of text = 2720</span></span>
<span class="line"><span>Length of compressed text = 2808</span></span></code></pre>
<p>AAAAHHH, why is the ‚Äúcompressed‚Äù version longer? Well this is part of why compression algorithms are a bit complicated. Our method works, except we made 1 mistake, we ordered our list of common words by length. In theory this should save the most space because the longest words have the shortest indicies (i.e. compression is index 0 which should save 10 bytes per occurance). The problem is short words. For example ‚Äúa‚Äù is index 207, this means we‚Äôre actually adding 2 bytes for every occurance of ‚Äúa‚Äù.</p>
<p><img src="/tech/blog/compression/a.png" alt=""></p>
<h3 id="some-improvements">Some improvements</h3>
<p>When looking at the list of terms remove any term where the index is the same size, or has more digits than the length of text (i.e 12 for ‚ÄúA‚Äù would be rejected 103 for ‚Äúthe‚Äù would be rejected, but 12 for ‚Äúthe‚Äù would work). We can remove all 1 letter words because no matter what we need at least 1 number to represent them which means it will never be compressed. For example is ‚ÄúA‚Äù is given index 0 it still doesn‚Äôt save any space, so we just don‚Äôt include it. This code would be:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> is_word_longer_than_index</span><span style="color:#E1E4E8">(word:</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">, index:</span><span style="color:#79B8FF">int</span><span style="color:#E1E4E8">) -> </span><span style="color:#79B8FF">bool</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#6A737D">    # Takes in a word and an index indicator and makes sure the length of the word is longer than the digits in the index</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#79B8FF"> len</span><span style="color:#E1E4E8">(word) </span><span style="color:#F97583">></span><span style="color:#79B8FF"> len</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">(index)):</span></span>
<span class="line"><span style="color:#F97583">        return</span><span style="color:#79B8FF"> True</span></span>
<span class="line"><span style="color:#F97583">    else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#F97583">        return</span><span style="color:#79B8FF"> False</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> compress_by_common_words_improved</span><span style="color:#E1E4E8">(input_text: </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">) -> </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#9ECBFF">    """Takes in some input text and returns the compressed form"""</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#6A737D">    # 1. Create a list of the most common english words</span></span>
<span class="line"><span style="color:#E1E4E8">    common_words </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> ...</span><span style="color:#6A737D"> # Same as last example, removed for brevity</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    ## 1.2 Add capitalized version of the words</span></span>
<span class="line"><span style="color:#E1E4E8">    common_words </span><span style="color:#F97583">+=</span><span style="color:#E1E4E8"> [word.capitalize() </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> word </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> common_words]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    ## 1.3 Sort by length; Shortest word first</span></span>
<span class="line"><span style="color:#E1E4E8">    common_words </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> sorted</span><span style="color:#E1E4E8">(common_words, </span><span style="color:#FFAB70">key</span><span style="color:#F97583">=</span><span style="color:#79B8FF">len</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#6A737D">    ## 1.4 Remove words that are shorter than their index</span></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#E1E4E8"> index, word </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> enumerate</span><span style="color:#E1E4E8">(common_words):</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#F97583"> not</span><span style="color:#E1E4E8"> is_word_longer_than_index(word, index):</span></span>
<span class="line"><span style="color:#E1E4E8">            common_words.pop(index)</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#6A737D">    # 2. Loop over the list of words</span></span>
<span class="line"><span style="color:#E1E4E8">    result </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> input_text</span></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#E1E4E8"> word </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> common_words:</span></span>
<span class="line"><span style="color:#6A737D">        ## 2.1 Replace each occurance of a word in the input text with</span></span>
<span class="line"><span style="color:#6A737D">        ## it's index in the common words list</span></span>
<span class="line"><span style="color:#E1E4E8">        result </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> result.replace(word, </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">(common_words.index(word)))</span></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#E1E4E8"> result</span></span></code></pre>
<p>With this change we went from 206 items in <code>common_words</code> down to 190, but even though we only removed 16 words the reorganizing gave us the following output:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span>Original Length of text = 2720</span></span>
<span class="line"><span>Length of compressed text = 2467</span></span></code></pre>
<p>That‚Äôs ~%10 space savings!</p>
<h3 id="an-even-better-option">An even Better option</h3>
<p>We wasted a lot of space in our <code>common_words</code> list on words that don‚Äôt necessarily occur in the text (‚Äúday‚Äù, ‚Äúfirst‚Äù, ‚Äúwater‚Äù, ‚Äúoil‚Äù, etc.), it would be better if we only included words that occured in the text.</p>
<p>First let‚Äôs look at some extra python stuff you will need to know to understand the code. If you skipped it read the <a href="#list-and-dictionary-comprehensions">comprehension section</a> from the beginning of the article as well.</p>
<p><code>Counter</code>s are a data type included by default in python. They can be used to count the occurences of items in collections (lists, strings etc.). So for example if I had a list of strings representing the results of how people voted for their favourite format of content I could then count the results using:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> collections </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> Counter</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">responses </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#9ECBFF">"audio"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"audio"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"video"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"video"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"text"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"audio"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"text"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"audio"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"audio"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"video"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"video"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"text"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"audio"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"text"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"audio"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"audio"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"video"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"video"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"text"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"audio"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"text"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"audio"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"audio"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"video"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"video"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"text"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"audio"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"text"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"audio"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"audio"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"video"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"video"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"text"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"audio"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"text"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"audio"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"audio"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"video"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"video"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"text"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"audio"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"text"</span><span style="color:#E1E4E8">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(Counter(responses))</span></span>
<span class="line"></span></code></pre>
<p>Which results in <code>Counter({'audio': 18, 'video': 12, 'text': 12})</code>.</p>
<h4 id="the-algorithm">The Algorithm</h4>
<p>So our compression algorithm is:</p>
<ol>
<li>Create a dictionary of every word in the text with their number of occurences in the text</li>
<li>Filter the dictionary so that only items with 2 or more occurences are in the resulting list, then sort by length (longest first)</li>
<li>Remove any term where the index is the same size, or has more digits than the length of text</li>
<li>Loop over the list of words and replace each occurance of a word in the input text with it‚Äôs index in the common words list</li>
</ol>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> string</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> typing </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> Tuple, List</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> collections </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> Counter</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> compress_with_counter</span><span style="color:#E1E4E8">(input_text:</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">) -> Tuple[</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">, List[</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">]]:</span></span>
<span class="line"><span style="color:#6A737D">    # Compression using the counter method</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#6A737D">    # 1. Create dictionary of word occurences</span></span>
<span class="line"><span style="color:#6A737D">    ## 1.1 Remove punctuation from input text</span></span>
<span class="line"><span style="color:#E1E4E8">    counter_text </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> input_text.translate(</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">.maketrans(</span><span style="color:#9ECBFF">''</span><span style="color:#E1E4E8">,</span><span style="color:#9ECBFF">''</span><span style="color:#E1E4E8">,string.punctuation,))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    ## 1.2 Split input text into a list of words so they can be counted</span></span>
<span class="line"><span style="color:#E1E4E8">    counter_text </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> counter_text.split(</span><span style="color:#9ECBFF">" "</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    ## 1.3 Count occurances of words in the text</span></span>
<span class="line"><span style="color:#E1E4E8">    counter </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> Counter(counter_text)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    # 2. Filter to only terms with 2 or more items</span></span>
<span class="line"><span style="color:#E1E4E8">    terms </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> {x: count </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> x, count </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> counter.items() </span><span style="color:#F97583">if</span><span style="color:#E1E4E8"> count </span><span style="color:#F97583">>=</span><span style="color:#79B8FF"> 2</span><span style="color:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    ## 2.1 Sort words by length; longest first</span></span>
<span class="line"><span style="color:#E1E4E8">    words </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> sorted</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">list</span><span style="color:#E1E4E8">(terms.keys()), </span><span style="color:#FFAB70">key</span><span style="color:#F97583">=</span><span style="color:#79B8FF">len</span><span style="color:#E1E4E8">)[::</span><span style="color:#F97583">-</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    # 3. Remove words that are shorter than their index</span></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#E1E4E8"> index, word </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> enumerate</span><span style="color:#E1E4E8">(words):</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#F97583"> not</span><span style="color:#E1E4E8"> is_word_longer_than_index(word, index):</span></span>
<span class="line"><span style="color:#E1E4E8">            words.remove(word)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    # 4. Loop over the list of words</span></span>
<span class="line"><span style="color:#E1E4E8">    result </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> input_text</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#E1E4E8"> word </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> words:</span></span>
<span class="line"><span style="color:#6A737D">        ## 4.1 Replace each occurance of a word in the input text with</span></span>
<span class="line"><span style="color:#6A737D">        ## it's index in the words list</span></span>
<span class="line"><span style="color:#E1E4E8">        result </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> result.replace(word, </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">(words.index(word)))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#E1E4E8"> result, words</span></span></code></pre>
<p>With this approach we get the result:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span>Original Length of text = 2720</span></span>
<span class="line"><span>Length of compressed text = 1921</span></span></code></pre>
<p>That‚Äôs ~%30 space savings! While this is great it‚Äôs far from as efficient as more complex and robust compression systems (gzip can get up to %90). There is a reason we are returning the <code>words</code> list, and it‚Äôs so we can decompress the text later.</p>
<p>So now how do we get back our original text? Well we just go through and replace the indicies with the words right? Well‚Ä¶ yes and no. That‚Äôs the basic idea, but consider the text <code>9 12s 254y</code>, the three numbers are <code>(9,12,254)</code> right? Well if we replace indicies one at a time starting from 0 it would be considered <code>(9,1,2,2,5,4)</code> instead. So what we need to do is start from the <strong>last index</strong> and work our way backwards, so the largest numbers are replaced first:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> decompress</span><span style="color:#E1E4E8">(compressed_text: </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">, terms:</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">) -> </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#6A737D">    # Decompresses text based on index-replaced compression</span></span>
<span class="line"><span style="color:#E1E4E8">    result </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> compressed_text</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#6A737D">    # Start from last element</span></span>
<span class="line"><span style="color:#E1E4E8">    index </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> len</span><span style="color:#E1E4E8">(terms)</span><span style="color:#F97583">-</span><span style="color:#79B8FF">1</span></span>
<span class="line"><span style="color:#F97583">    while</span><span style="color:#E1E4E8"> index </span><span style="color:#F97583">>=</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#6A737D">        # Replace each element from end to beginning </span></span>
<span class="line"><span style="color:#E1E4E8">        result </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> result.replace(</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">(index), terms[index])</span></span>
<span class="line"><span style="color:#E1E4E8">        index </span><span style="color:#F97583">-=</span><span style="color:#79B8FF">1</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#E1E4E8"> result</span></span></code></pre>
<p>We will need to pass it the list used to compress the data so we have the correct indicies to decompress it with. So to use it we can do:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#E1E4E8">result, terms </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> compress_with_counter(input_text)</span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"Decompressed text is: </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">decompress(result, terms)</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span><span style="color:#E1E4E8">)</span></span></code></pre>
<p>Which gives us (text cut off to save space):</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span>Decompressed text is: "</span></span>
<span class="line"><span>Compression is a fundamental technique used in various fields to reduce the size of data while preserving its essential information. In computer science and information technology, data compression plays a crucial role in storage, transmission, and processing of large amounts of information. By eliminating redundancy and exploiting patterns in data, compression algorithms can significantly reduce file sizes, resulting in more efficient use of storage space and faster data transfer over networks. From simple algorithms like run-length encoding to sophisticated methods like Huffman coding and Lempel-Ziv-Welch (LZW) algorithm, compression enable..."</span></span></code></pre>
<p>In the real world we would export out the compressed text along with the list of words in some sort of format so we could store it long term and voila.</p>
<p>There‚Äôs still a major problem; How can we tell which numbers are part of the compression, and which numbers are part of the text? I‚Äôll leave you to try to solve those problems üòâ</p>
<h2 id="images">Images</h2>
<p>Let‚Äôs talk about a quick scheme to compress images. First we need to make up a fake encoding for storing image data. When we are looking at images they are broken up into little squares called pixels. Each pixel in our format will have 3 numbers between 0-255 representing the amount of red, green and blue. So for example if we had (255, 0, 0) that would be 100% red, (0, 255, 0) would be 100% Green and (0, 0, 255) would be 100% blue. Then also something like (127, 127, 127) would be a medium grey (0,0,0) would be pure black, and (255,255,255) would be pure white.</p>
<p><img src="/tech/blog/compression/colours.png" alt=""></p>
<p>We can then have a list of these tuples of 3 to represent pixels in an image. So for example this 5 pixel by 5 pixel image of the letter T (added white around the black to make the pixel lines clearer):</p>
<p><img src="/tech/blog/compression/pixel-image.png" alt=""></p>
<p>We end up with the following representation in code:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#E1E4E8">image_values </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span></span>
<span class="line"><span style="color:#E1E4E8">    [(</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">),(</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">),(</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">),(</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">),(</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">)],</span></span>
<span class="line"><span style="color:#E1E4E8">    [(</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">),      (</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">),(</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">),(</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">),      (</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">)],</span></span>
<span class="line"><span style="color:#E1E4E8">    [(</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">),(</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">),(</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">),(</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">),(</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">)],</span></span>
<span class="line"><span style="color:#E1E4E8">    [(</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">),(</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">),(</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">),(</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">),(</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">)],</span></span>
<span class="line"><span style="color:#E1E4E8">    [(</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">),(</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">),(</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">),(</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">),(</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">)],</span></span>
<span class="line"><span style="color:#E1E4E8">]</span></span></code></pre>
<p>Here is a visual representation of the mapping:</p>
<p><img src="/tech/blog/compression/values.png" alt=""></p>
<h3 id="the-algorithm-1">The algorithm</h3>
<p>Now we have our format we can start planning an algorithm</p>
<ol>
<li>Round each number up to the next multiple of 5 (except 255, which stays 255). So if we had the tuple <code>(120, 253, 119)</code> we would get <code>(125, 255, 120)</code> and if we had <code>(255, 0, 1)</code> we would get <code>(255, 5, 5)</code></li>
<li>Count the occurence of each tupple</li>
<li>Replace each tupple with the index of where it would appear in the list of occurences, until you reach 11 digits (10 billion item list) or more (since that‚Äôs longer than the tuple representation in text)</li>
</ol>
<p>The first step will make our algorithm lossy, we can be up to 12 bytes inaccurate in terms of colour from the original.</p>
<p>So if we have the example of:</p>
<p><img src="/tech/blog/compression/image-mapping.png" alt=""></p>
<p>We could compress using:</p>
<p><img src="/tech/blog/compression/image-mapping-compressed.png" alt=""></p>
<p>Then when we decode we just look for tuples of length 1 (like <code>(1)</code> instead of length 3 like <code>(255,255,255)</code>)</p>
<p>The code to do all of this is:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> typing </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> List, Tuple</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> collections </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> Counter</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> round_pixels</span><span style="color:#E1E4E8">(image_values: List[List[List[</span><span style="color:#79B8FF">int</span><span style="color:#E1E4E8">]]]) -> List[List[Tuple[</span><span style="color:#79B8FF">int</span><span style="color:#E1E4E8">]]]:</span></span>
<span class="line"><span style="color:#6A737D">    # Takes in a representation of image values, rounds the pixels to nearest number divisible </span></span>
<span class="line"><span style="color:#6A737D">    # by 5 and then returns the new representation with tuples instead of lists</span></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#E1E4E8"> row </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> image_values:</span></span>
<span class="line"><span style="color:#F97583">        for</span><span style="color:#E1E4E8"> pixel </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> row:</span></span>
<span class="line"><span style="color:#F97583">            for</span><span style="color:#E1E4E8"> index, value </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> enumerate</span><span style="color:#E1E4E8">(pixel):</span></span>
<span class="line"><span style="color:#F97583">                if</span><span style="color:#E1E4E8"> value </span><span style="color:#F97583">%</span><span style="color:#79B8FF"> 5</span><span style="color:#F97583"> ==</span><span style="color:#79B8FF"> 0</span><span style="color:#E1E4E8">: </span><span style="color:#6A737D"># Value is divisible by 5</span></span>
<span class="line"><span style="color:#F97583">                    continue</span></span>
<span class="line"><span style="color:#F97583">                else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#F97583">                    if</span><span style="color:#79B8FF"> len</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">(value)) </span><span style="color:#F97583">==</span><span style="color:#79B8FF">3</span><span style="color:#E1E4E8">: </span><span style="color:#6A737D"># 3 digit number</span></span>
<span class="line"><span style="color:#F97583">                        if</span><span style="color:#79B8FF"> int</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">(value)[</span><span style="color:#F97583">-</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">]) </span><span style="color:#F97583">></span><span style="color:#79B8FF"> 5</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">                            pixel[index] </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> int</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"</span><span style="color:#79B8FF">{str</span><span style="color:#E1E4E8">(value)[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">]</span><span style="color:#79B8FF">}{int</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">(value)[</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">])</span><span style="color:#F97583">+</span><span style="color:#79B8FF">1}</span><span style="color:#9ECBFF">0"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">                        else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">                            pixel[index]</span><span style="color:#F97583">=</span><span style="color:#79B8FF"> int</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"</span><span style="color:#79B8FF">{str</span><span style="color:#E1E4E8">(value)[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">]</span><span style="color:#79B8FF">}{str</span><span style="color:#E1E4E8">(value)[</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">]</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">5"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">                    elif</span><span style="color:#79B8FF"> len</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">(value)) </span><span style="color:#F97583">==</span><span style="color:#79B8FF">2</span><span style="color:#E1E4E8">: </span><span style="color:#6A737D"># 2 digit number</span></span>
<span class="line"><span style="color:#F97583">                        if</span><span style="color:#79B8FF"> int</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">(value)[</span><span style="color:#F97583">-</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">]) </span><span style="color:#F97583">></span><span style="color:#79B8FF"> 5</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">                            pixel[index] </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> int</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"</span><span style="color:#79B8FF">{int</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">(value)[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">])</span><span style="color:#F97583">+</span><span style="color:#79B8FF">1}</span><span style="color:#9ECBFF">0"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">                        else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">                            pixel[index]</span><span style="color:#F97583">=</span><span style="color:#79B8FF"> int</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"</span><span style="color:#79B8FF">{str</span><span style="color:#E1E4E8">(value)[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">]</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">5"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">                    elif</span><span style="color:#79B8FF"> len</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">(value)) </span><span style="color:#F97583">==</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">: </span><span style="color:#6A737D"># single digit number</span></span>
<span class="line"><span style="color:#F97583">                        if</span><span style="color:#E1E4E8"> value </span><span style="color:#F97583">></span><span style="color:#79B8FF"> 5</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">                            pixel[index] </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 10</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#F97583">                        else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">                            pixel[index] </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    # Convert lists to tuples since  lists can't be used with Counter</span></span>
<span class="line"><span style="color:#E1E4E8">    image_values </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [[</span><span style="color:#79B8FF">tuple</span><span style="color:#E1E4E8">(pixel) </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> pixel </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> row] </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> row </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> image_values]</span></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#E1E4E8"> image_values</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> compress_image</span><span style="color:#E1E4E8">(image_values: List[List[List[</span><span style="color:#79B8FF">int</span><span style="color:#E1E4E8">]]]):</span></span>
<span class="line"><span style="color:#6A737D">    # 1. "Round" pixel values to nearest multiple of 5</span></span>
<span class="line"><span style="color:#E1E4E8">    image_values </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> round_pixels(image_values)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    # 2. Count tuple occurances</span></span>
<span class="line"><span style="color:#E1E4E8">    counter </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> Counter()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#E1E4E8"> row </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> image_values:</span></span>
<span class="line"><span style="color:#F97583">        for</span><span style="color:#E1E4E8"> pixel </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> row:</span></span>
<span class="line"><span style="color:#E1E4E8">            counter[pixel] </span><span style="color:#F97583">+=</span><span style="color:#79B8FF"> 1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    # 2.1 Convert to dictionary to make it easier to work with</span></span>
<span class="line"><span style="color:#E1E4E8">    terms </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> dict</span><span style="color:#E1E4E8">(counter)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    ## 2.2 Make a list of the terms</span></span>
<span class="line"><span style="color:#E1E4E8">    common_pixels </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> list</span><span style="color:#E1E4E8">(terms.keys())</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#6A737D">    ## 2.3 Raise an error if the compression would result in larger files</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#79B8FF"> len</span><span style="color:#E1E4E8">(common_pixels) </span><span style="color:#F97583">></span><span style="color:#79B8FF"> 10_000_000_000</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#F97583">        raise</span><span style="color:#79B8FF"> ValueError</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"Image has too many unique values to be compressed"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    # 3. Replace occurences of tuples with their index in the list of common pixels</span></span>
<span class="line"><span style="color:#E1E4E8">    result </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> image_values</span></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#E1E4E8"> index, row </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> enumerate</span><span style="color:#E1E4E8">(result):</span></span>
<span class="line"><span style="color:#F97583">        for</span><span style="color:#E1E4E8"> inner_list_index, pixel </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> enumerate</span><span style="color:#E1E4E8">(row):</span></span>
<span class="line"><span style="color:#E1E4E8">            result[index][inner_list_index] </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> tuple</span><span style="color:#E1E4E8">([common_pixels.index(pixel) </span><span style="color:#F97583">if</span><span style="color:#E1E4E8"> pixel </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> common_pixels </span><span style="color:#F97583">else</span><span style="color:#E1E4E8"> pixel])</span></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#E1E4E8"> result, common_pixels</span></span></code></pre>
<p>We can then test it using:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#E1E4E8">image_values </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [ </span></span>
<span class="line"><span style="color:#6A737D">    # Start with third dimension being a list so the values can be rounded (tuples are immutable)</span></span>
<span class="line"><span style="color:#E1E4E8">    [[</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">],[</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">],[</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">],[</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">],[</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">]],</span></span>
<span class="line"><span style="color:#E1E4E8">    [[</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">],      [</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">],[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">],[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">],      [</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">]],</span></span>
<span class="line"><span style="color:#E1E4E8">    [[</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">],[</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">],[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">],[</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">],[</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">]],</span></span>
<span class="line"><span style="color:#E1E4E8">    [[</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">],[</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">],[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">],[</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">],[</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">]],</span></span>
<span class="line"><span style="color:#E1E4E8">    [[</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">],[</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">],[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">],[</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">],[</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">]],</span></span>
<span class="line"><span style="color:#E1E4E8">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"Original size of image = </span><span style="color:#79B8FF">{len</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">(image_values))</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">result, common_pixels </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> compress_image(image_values)</span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"Compressed size of image = </span><span style="color:#79B8FF">{len</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">(result))</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span><span style="color:#E1E4E8">)</span></span></code></pre>
<p>Which in our case gives us:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span>Original Length of text = 399</span></span>
<span class="line"><span>Length of compressed text = 160</span></span></code></pre>
<p>Which is not bad, it‚Äôs about ~%60 efficient.</p>
<p>and then to decompress would be:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> decompress_image</span><span style="color:#E1E4E8">(image_values:List[List[Tuple[</span><span style="color:#79B8FF">int</span><span style="color:#E1E4E8">]]], common_pixels:List[Tuple[</span><span style="color:#79B8FF">int</span><span style="color:#E1E4E8">]]):</span></span>
<span class="line"><span style="color:#6A737D">    # Takes in a compressed image, and the mapping used to compress it, and decompresses back to original form</span></span>
<span class="line"><span style="color:#E1E4E8">    result </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> image_values</span></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#E1E4E8"> index, row </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> enumerate</span><span style="color:#E1E4E8">(result):</span></span>
<span class="line"><span style="color:#F97583">        for</span><span style="color:#E1E4E8"> j_index, pixel </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> enumerate</span><span style="color:#E1E4E8">(row):</span></span>
<span class="line"><span style="color:#F97583">            if</span><span style="color:#79B8FF"> len</span><span style="color:#E1E4E8">(pixel) </span><span style="color:#F97583">==</span><span style="color:#79B8FF"> 1</span><span style="color:#E1E4E8">: </span><span style="color:#6A737D"># Was compressed, convert back to original value</span></span>
<span class="line"><span style="color:#E1E4E8">                result[index][j_index] </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> tuple</span><span style="color:#E1E4E8">([common_pixels[pixel[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">]]])</span></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#E1E4E8"> result</span></span></code></pre>
<p>This works well, but it cannot run for images above a few hundred pixels by a few hundred pizels because it is very inefficient. You can test this yourself by generating some test data using the following function:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> create_test_data</span><span style="color:#E1E4E8">(width:</span><span style="color:#79B8FF">int</span><span style="color:#E1E4E8">, height:</span><span style="color:#79B8FF">int</span><span style="color:#E1E4E8">) -> List[List[List[</span><span style="color:#79B8FF">int</span><span style="color:#E1E4E8">]]]:</span></span>
<span class="line"><span style="color:#6A737D">    # Generates test data to be used with compress_image()</span></span>
<span class="line"><span style="color:#E1E4E8">    result </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> []</span></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#E1E4E8"> row </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(width):</span></span>
<span class="line"><span style="color:#E1E4E8">        current_row </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> []</span></span>
<span class="line"><span style="color:#F97583">        for</span><span style="color:#E1E4E8"> column </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(height):</span></span>
<span class="line"><span style="color:#E1E4E8">            current_row.append([random.randint(</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">), random.randint(</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">), random.randint(</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">)])</span></span>
<span class="line"><span style="color:#E1E4E8">        result.append(current_row)</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#E1E4E8"> result</span></span></code></pre>
<p>Testing with:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#E1E4E8">image_values </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> create_test_data(</span><span style="color:#79B8FF">200</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">200</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"Original Length of text = </span><span style="color:#79B8FF">{len</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">(image_values))</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">result, common_pixels </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> compress_image(image_values)</span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"Length of compressed text = </span><span style="color:#79B8FF">{len</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">(result))</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"Compression ratio is ~%</span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">((</span><span style="color:#79B8FF">len</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">(result))</span><span style="color:#F97583">/</span><span style="color:#79B8FF">len</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">(image_values))))</span><span style="color:#F97583">*</span><span style="color:#79B8FF">100}</span><span style="color:#9ECBFF">"</span><span style="color:#E1E4E8">)</span></span></code></pre>
<p>Which gives us:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span>Original Length of text = 628658</span></span>
<span class="line"><span>Length of compressed text = 386393</span></span>
<span class="line"><span>Compression ratio is ~%60.9185562166747</span></span></code></pre>
<p>It took a min or two on my machine, but at 500,500 it still wasn‚Äôt done after 5 mins. The scaling is very poor because it has to check every value of every pixel, so for 200x200 that‚Äôs 40,000 checks, and for 500x500 that‚Äôs 250,000 checks and for each pixel we need to round the values üòµ‚Äçüí´. Try to figure out a more efficient way of doing this if you can!</p>
<h2 id="file-types">File types</h2>
<p>There are generally 2 types of files:</p>
<ul>
<li>Text files</li>
<li>Binary files</li>
</ul>
<p>Text files are just plain text that have some sort of encoding. They are meant to be readable and are used for things like source code, plain text files, markup files etc.</p>
<p>Binary files are files that either:</p>
<ol>
<li>Are meant to be run with a specific program (i.e. PDF‚Äôs need a PDF reader, images need a photo viewer etc.)</li>
<li>Are meant to be executed (i.e. an application)</li>
</ol>
<p>For images you will mostly be working with binary files, these are a bit different than text files. With text files it makes sense for us to simply read each word or letter, with binary files the organization of data changes by file type. For one file like a binary format spreadsheet maybe you want all the data until a <code>;</code> or <code>,</code> in the file, whereas for images you may want tuples of 3 numbers <code>(255,255,255)</code> which correspond to RGB values.</p>
<p>Each binary file differs in how you want to read it, so be careful when working with them. For most image-related activities check out <a href="https://pypi.org/project/Pillow/">pillow</a> for python!</p>
<h2 id="video">Video</h2>
<p>This article is already long enough so we are going to skip video because it‚Äôs quite a bit more complicated. See the section below for common real-world examples, and take a look at our section about <a href="/definitions/compression#sampling">sampling</a> in the compression defition.</p>
<h2 id="real-world-compression-systems">Real world compression systems</h2>
<p>Most real world compression systems are based on the encoding they use. But here are a few examples you can look at:</p>
<p><strong>Text</strong></p>
<p>Algorithms that make up common compression systems</p>
<ul>
<li>Huffman Coding (this solves the problem of numbers in our algorithm)
<ul>
<li><a href="https://www.youtube.com/watch?v=JsTptu56GM8">How Computers Compress Text: Huffman Coding and Huffman Trees</a></li>
<li><a href="https://www.youtube.com/watch?v=iEm1NRyEe5c">Huffman coding step-by-step example</a></li>
<li><a href="https://www.youtube.com/watch?v=umTbivyJoiI">How Huffman Trees Work - Computerfile</a></li>
<li><a href="https://cmps-people.ok.ubc.ca/ylucet/DS/Huffman.html">Huffman Coding Visualizer</a></li>
</ul>
</li>
<li>LZ77/LZ1
<ul>
<li><a href="https://www.youtube.com/watch?v=goOa3DGezUA">Elegant Compression in Text (The LZ 77 Method) - Computerphile</a></li>
<li><a href="https://www.youtube.com/watch?v=RV5aUr8sZD0">The Beauty of Lempel-Ziv Compression</a></li>
<li><a href="https://www.youtube.com/watch?v=jVcTrBjI-eE">Learn in 5 Minutes: LZ77 Compression Algorithms</a></li>
<li><a href="https://www.youtube.com/watch?v=zev2A2uWYsM">17. LZ77 Encoding, decoding with examples.</a></li>
<li><a href="https://kg86.github.io/visstr/dist/vis_str_demo.html">String Visualizer</a></li>
</ul>
</li>
<li>Deflate
<ul>
<li><a href="https://www.youtube.com/watch?v=O1NATKw6G_U">An explanation of the Deflate Algorithm</a></li>
<li><a href="https://www.zlib.net/feldspar.html">An Explanation of the Deflate Algorithm (original publication)</a></li>
<li><a href="https://www.youtube.com/watch?v=oi2lMBBjQ8s">Data Compression (Summer 2020) - Lecture 11 - DEFLATE (gzip)</a></li>
</ul>
</li>
</ul>
<p>Common compression systems (Use deflate, huffman coding, and LZ77/LZ1)</p>
<ul>
<li>Gzip; A generic compression system used in most browsers and applications
<ul>
<li><a href="https://www.youtube.com/watch?v=NLtt4S9ErIA">Gzip file compression in 100 seconds</a></li>
<li><a href="https://www.youtube.com/watch?v=maL-SqyXvj8">How Gzip Compression Works</a></li>
<li><a href="https://www.youtube.com/watch?v=wLx5OGxOYUc">Raul Fraile: How GZIP compression works | JSConf EU 2014</a></li>
</ul>
</li>
<li>Brotli; A webpage optimized compression system
<ul>
<li><a href="https://www.youtube.com/watch?v=Uiyu3uo4OAE">Brotli Compression vs GZIP Compression</a></li>
<li><a href="https://www.brotli.org/">Brotli site</a></li>
<li><a href="https://github.com/google/brotli">Source code</a></li>
</ul>
</li>
</ul>
<p><strong>Image</strong></p>
<ul>
<li>JPG; Very common <a href="#lossy">lossy</a> image compression
<ul>
<li><a href="https://www.youtube.com/watch?v=Kv1Hiv3ox8I">This video</a></li>
<li>These two videos from computephile
<ul>
<li><a href="https://www.youtube.com/watch?v=n_uNPbdenRs">Part 1</a></li>
<li><a href="https://www.youtube.com/watch?v=Q2aEzeMDHMA">Part 2</a></li>
</ul>
</li>
<li><a href="https://en.wikibooks.org/wiki/JPEG_-_Idea_and_Practice">This set of articles</a></li>
</ul>
</li>
<li>PNG; Common <a href="#lossless">lossless</a> image format that also supports transparency
<ul>
<li><a href="https://medium.com/@duhroach/how-png-works-f1174e3cc7b7">How PNG Works</a></li>
<li><a href="https://www.youtube.com/watch?v=EFUYNoFRHQI">How PNG Works: Compromising Speed for Quality</a></li>
<li><a href="https://compress-or-die.com/Understanding-PNG">Finally understanding PNG</a></li>
</ul>
</li>
<li>Base64; A text-based way of storing image data
<ul>
<li><a href="https://www.youtube.com/watch?v=7gSSMy_M4HU">Base64 Encoding/Decoding explained</a></li>
<li><a href="https://www.youtube.com/watch?v=EPlXPdNvQEY">How to Convert Images Into Base 64 Data URLs with JavaScript</a></li>
<li><a href="https://www.youtube.com/watch?v=fe062UdOKuo">Reduce base64 image file size | JavaScript</a></li>
</ul>
</li>
</ul>
<p>A good broad topic video can be found <a href="https://www.youtube.com/watch?v=Ba89cI9eIg8">here</a></p>
<p><strong>Video</strong></p>
<ul>
<li>MPEG; Set of formats used for videos (mpeg-4 is also known at <code>.mp4</code> files)
<ul>
<li><a href="https://www.youtube.com/watch?v=F0ZinF-gTrY">What is MPEG Format | What is MPEG 4 Format | What are MPEG 1, MPEG 2 &#x26; MPEG 21</a></li>
<li><a href="https://www.youtube.com/watch?v=Ky4CaKw7tdo">MPEG Algorithm - Video &#x26; Audio Compression - Data Compression &#x26; Encryption</a></li>
</ul>
</li>
<li>h.264; THe encoding used for most videos on the web today
<ul>
<li><a href="https://www.youtube.com/watch?v=J9RemuYxA4s">H.264 Part 1: Encoding &#x26; Decoding Basics</a></li>
<li><a href="https://www.youtube.com/watch?v=1PMqXdWJHNs">H 264 Video Compression</a></li>
<li><a href="https://www.vcodex.com/an-overview-of-h264-advanced-video-coding/">An Overview of H.264 Advanced Video Coding</a></li>
<li><a href="https://api.video/what-is/h-264/">api.video h.264</a></li>
<li><a href="https://www.e-consystems.com/blog/camera/technology/what-is-h-264-video-encoding-how-does-h-264-codec-work/">What is H.264 video encoding? How does H.264 codec work?</a></li>
</ul>
</li>
</ul>
<p>Most commonly videos are MPEG-4 (<code>.mp4</code>) using a <code>h.264</code> codec to encode the data. A good broad topic video can be found <a href="https://www.youtube.com/watch?v=QoZ8pccsYo4">here</a></p>  </article> </main> <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js" integrity="sha256-mm3Re3y7xlvh+yCD+l/Zs1d+PU0AEad93MkWvljfm/s=" crossorigin="anonymous"></script>   </main> </div> <footer class="footer footer-center block mb-5 pt-10"> <div class="pb-2">
&copy; 2025 Kieran Wood
</div> <div class="inline opacity-75"> <!-- Thanks for using this template. You can keep this line to support my work :) --> <a href="https://astrofy-template.netlify.app/" target="_blank" class="font-bold">Astrofy Template</a> developed by
<a href="https://manuelernestog.github.io" target="_blank" class="font-bold">Manuel Ernesto ‚ö°Ô∏è</a> </div> </footer>  </div> <div class="drawer-side z-40"> <label for="my-drawer" class="drawer-overlay"></label> <aside class="px-2 pt-2 h-auto min-h-full w-[19rem] bg-base-200 text-base-content flex flex-col"> <div class="w-fit mx-auto mt-5 mb-6"> <a href="/"> <div class="avatar transition ease-in-out hover:scale-[102%] block m-auto"> <div class="w-[8.5rem]"> <img src="/tech/profile.jpg" class="mask mask-circle" alt="Profile image" width="300" height="300" loading="lazy" decoding="async"> </div> </div> </a> </div> <ul class="menu grow shrink menu-md overflow-y-auto"> <li><a class="py-3 text-base" id="home" href="/tech/">Home</a></li> <li><a class="py-3 text-base" id="projects" href="/tech/projects">Projects</a></li> <!-- <li><a class="py-3 text-base" id="services" href="/tech/services">Services</a></li>
    <li><a class="py-3 text-base" id="store" href="/tech/store">Store</a></li> --> <li><a class="py-3 text-base" id="blog" href="/tech/blog/">Blog</a></li> <li><a class="py-3 text-base" id="cv" href="/tech/cv">CV</a></li> <li><a class="py-3 text-base" href="/tech/contact">Contact</a></li> </ul> <script>(function(){const sideBarActiveItemID = undefined;
const activeClass = "bg-base-300";

const activeItemElem = document.getElementById(sideBarActiveItemID);
activeItemElem && activeItemElem.classList.add(activeClass);
})();</script> <div class="block sticky pointer-events-none bottom-10 bg-base-200 justify-center h-12 [mask-image:linear-gradient(transparent,#000000)]"></div> <div class="social-icons px-4 pb-5 pt-1 flex self-center justify-center sticky bottom-0 bg-base-200"> <a href="https://github.com/descent098" target="_blank" class="mx-3" aria-label="Github" title="Github"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" style="fill: currentColor;transform: ;msFilter:;"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.026 2c-5.509 0-9.974 4.465-9.974 9.974 0 4.406 2.857 8.145 6.821 9.465.499.09.679-.217.679-.481 0-.237-.008-.865-.011-1.696-2.775.602-3.361-1.338-3.361-1.338-.452-1.152-1.107-1.459-1.107-1.459-.905-.619.069-.605.069-.605 1.002.07 1.527 1.028 1.527 1.028.89 1.524 2.336 1.084 2.902.829.091-.645.351-1.085.635-1.334-2.214-.251-4.542-1.107-4.542-4.93 0-1.087.389-1.979 1.024-2.675-.101-.253-.446-1.268.099-2.64 0 0 .837-.269 2.742 1.021a9.582 9.582 0 0 1 2.496-.336 9.554 9.554 0 0 1 2.496.336c1.906-1.291 2.742-1.021 2.742-1.021.545 1.372.203 2.387.099 2.64.64.696 1.024 1.587 1.024 2.675 0 3.833-2.33 4.675-4.552 4.922.355.308.675.916.675 1.846 0 1.334-.012 2.41-.012 2.737 0 .267.178.577.687.479C19.146 20.115 22 16.379 22 11.974 22 6.465 17.535 2 12.026 2z"></path> </svg> </a> <a href="https://www.linkedin.com/in/kieran-wood" target="_blank" class="mx-3" aria-label="Linkedin" title="Linkedin"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" style="fill: currentColor;transform: ;msFilter:;"><circle cx="4.983" cy="5.009" r="2.188"></circle><path d="M9.237 8.855v12.139h3.769v-6.003c0-1.584.298-3.118 2.262-3.118 1.937 0 1.961 1.811 1.961 3.218v5.904H21v-6.657c0-3.27-.704-5.783-4.526-5.783-1.835 0-3.065 1.007-3.568 1.96h-.051v-1.66H9.237zm-6.142 0H6.87v12.139H3.095z"></path> </svg> </a> <a href="https://instagram.com/descent098" target="_blank" class="mx-3" aria-label="Instagram" title="Instagram"> <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 -5 24 24" style="fill: currentColor;transform: ;msFilter:;"><path d="M8 0C5.829 0 5.556.01 4.703.048 3.85.088 3.269.222 2.76.42a3.917 3.917 0 0 0-1.417.923A3.927 3.927 0 0 0 .42 2.76C.222 3.268.087 3.85.048 4.7.01 5.555 0 5.827 0 8.001c0 2.172.01 2.444.048 3.297.04.852.174 1.433.372 1.942.205.526.478.972.923 1.417.444.445.89.719 1.416.923.51.198 1.09.333 1.942.372C5.555 15.99 5.827 16 8 16s2.444-.01 3.298-.048c.851-.04 1.434-.174 1.943-.372a3.916 3.916 0 0 0 1.416-.923c.445-.445.718-.891.923-1.417.197-.509.332-1.09.372-1.942C15.99 10.445 16 10.173 16 8s-.01-2.445-.048-3.299c-.04-.851-.175-1.433-.372-1.941a3.926 3.926 0 0 0-.923-1.417A3.911 3.911 0 0 0 13.24.42c-.51-.198-1.092-.333-1.943-.372C10.443.01 10.172 0 7.998 0h.003zm-.717 1.442h.718c2.136 0 2.389.007 3.232.046.78.035 1.204.166 1.486.275.373.145.64.319.92.599.28.28.453.546.598.92.11.281.24.705.275 1.485.039.843.047 1.096.047 3.231s-.008 2.389-.047 3.232c-.035.78-.166 1.203-.275 1.485a2.47 2.47 0 0 1-.599.919c-.28.28-.546.453-.92.598-.28.11-.704.24-1.485.276-.843.038-1.096.047-3.232.047s-2.39-.009-3.233-.047c-.78-.036-1.203-.166-1.485-.276a2.478 2.478 0 0 1-.92-.598 2.48 2.48 0 0 1-.6-.92c-.109-.281-.24-.705-.275-1.485-.038-.843-.046-1.096-.046-3.233 0-2.136.008-2.388.046-3.231.036-.78.166-1.204.276-1.486.145-.373.319-.64.599-.92.28-.28.546-.453.92-.598.282-.11.705-.24 1.485-.276.738-.034 1.024-.044 2.515-.045v.002zm4.988 1.328a.96.96 0 1 0 0 1.92.96.96 0 0 0 0-1.92zm-4.27 1.122a4.109 4.109 0 1 0 0 8.217 4.109 4.109 0 0 0 0-8.217zm0 1.441a2.667 2.667 0 1 1 0 5.334 2.667 2.667 0 0 1 0-5.334"></path> </svg> </a> <a href="/rss.xml" target="_blank" class="mx-3" aria-label="RSS Feed" title="RSS Feed"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" style="fill: currentColor;transform: ;msFilter:;"><path d="M19 20.001C19 11.729 12.271 5 4 5v2c7.168 0 13 5.832 13 13.001h2z"></path><path d="M12 20.001h2C14 14.486 9.514 10 4 10v2c4.411 0 8 3.589 8 8.001z"></path><circle cx="6" cy="18" r="2"></circle> </svg> </a> </div> </aside> </div> </div> </body></html>